import{Q as V,a as D}from"./QBreadcrumbs.9c06453f.js";import{Q as p}from"./QSeparator.68732f5d.js";import{_ as v,o as u,j as f,e as b,l as c,v as g,i as t,f as l,w as s,r as y,t as n,Q as x,F as S,k as q,aM as E,aN as I}from"./index.1080353d.js";import{Q as B}from"./QMarkupTable.c0451a53.js";import{Q as A}from"./QPage.23d4180f.js";import{g as P,a as T}from"./api.65cb3913.js";import{Q as w}from"./QCardSection.f803a29f.js";import{Q as _}from"./QInput.1bee1665.js";import{Q as F}from"./QDate.97cabd6f.js";import{Q as N}from"./QPopupProxy.7d04538f.js";import{Q as R}from"./QCardActions.3667cdb7.js";import{Q as M}from"./QCard.88f5c900.js";import{Q as U}from"./QDialog.27353340.js";import{Q as j}from"./QForm.28e3ca0c.js";import"./use-dark.6b0451ed.js";import"./axios.8558e732.js";import"./use-key-composition.29ef2a66.js";import"./use-split-attrs.338740ca.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./use-form.ed2be5bd.js";import"./format.2bc25e5f.js";import"./QMenu.9bbdcf7b.js";import"./selection.c4975593.js";import"./use-timeout.cd2175e4.js";import"./focusout.364dbcfd.js";import"./use-transition.32cb9394.js";import"./scroll.fa986778.js";import"./use-prevent-scroll.b4dcc30f.js";const L={props:{showButton:{type:Boolean,required:!1,default:!0}},data(){return{showModal:!1,loading:!1,showDialog:!1,showPop:!1,themes:[],formData:{title:"",is_active:!1,date_range:{from:"",to:""},date_from:"",date_to:""},formErrors:{},rules:{required:e=>!!e||"This field is required",dateRangeFrom:e=>!e||!this.formData.date_range.to||e<=this.formData.date_range.to||"Start date must be less than end date",dateRangeTo:e=>!e||!this.formData.date_range.from||e>=this.formData.date_range.from||"End date must be greater than start date"}}},created(){var e,a;P().then(m=>this.themes=m),this.formData.call=(a=(e=this.$dataStore)==null?void 0:e.currentCall)==null?void 0:a.id},methods:{createCall(){this.formData.date_from=this.formData.date_range.from.replaceAll("/","-"),this.formData.date_to=this.formData.date_range.to.replaceAll("/","-"),console.log(this.formData),this.$api.post("calls/",this.formData).then(e=>{console.log("Call created successfully",e.data.id),e.status===201&&e.data.id&&this.$router.push(`/calls/${e.data.id}`)})},setDateRange(){console.log(this.formData.date_range.from,this.formData.date_range.to),this.formData.date_from=this.formData.date_range.from,this.formData.date_to=this.formData.date_range.to,this.showPop=!1},cancelCreate(){this.showDialog=!1},setFormData(){this.formData={title:"sd;d;wdw",is_active:!1,date_range:{from:"2025/04/01",to:"2025/04/30"},date_from:"2025-04-01",date_to:"2025-04-30"}}},watch:{showPopup(e,a){this.showDialog=e},showDialog(e,a){this.$emit("showPopupChanged",e)}}},z=t("div",{class:"text-h6"},"New Call",-1),H={class:"q-mt-md"},G=t("label",{class:"text-grey text-caption"}," Select Call Duration ",-1),J={class:"row q-gutter-sm col"};function K(e,a,m,k,o,d){return u(),f("div",null,[m.showButton?(u(),b(c,{key:0,label:"New Call",color:"primary",onClick:a[0]||(a[0]=r=>o.showDialog=!0)})):g("",!0),t("div",null,[l(j,{onSubmit:d.createCall,class:"justify-center"},{default:s(()=>[l(U,{modelValue:o.showDialog,"onUpdate:modelValue":a[6]||(a[6]=r=>o.showDialog=r),persistent:""},{default:s(()=>[l(M,{style:{width:"500px"}},{default:s(()=>[l(w,{class:"row justify-between"},{default:s(()=>[z,l(c,{color:"primary",icon:"close",dense:"",flat:"",onClick:d.cancelCreate},null,8,["onClick"])]),_:1}),l(p),l(w,{class:"q-pt-lg q-pb-md"},{default:s(()=>[l(_,{modelValue:o.formData.title,"onUpdate:modelValue":a[1]||(a[1]=r=>o.formData.title=r),label:"Title of your call",outlined:"",required:"",rules:[o.rules.required]},null,8,["modelValue","rules"]),t("div",H,[G,t("div",J,[l(_,{class:"col",modelValue:o.formData.date_from,"onUpdate:modelValue":a[2]||(a[2]=r=>o.formData.date_from=r),type:"text",label:"From?",outlined:"",disable:!0},null,8,["modelValue"]),l(_,{class:"col",modelValue:o.formData.date_to,"onUpdate:modelValue":a[3]||(a[3]=r=>o.formData.date_to=r),type:"text",label:"To?",outlined:"",disable:!0},null,8,["modelValue"]),l(c,{icon:"event",outline:"",color:"primary"},{default:s(()=>[l(N,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:o.showPop,"onUpdate:modelValue":a[5]||(a[5]=r=>o.showPop=r)},{default:s(()=>[l(F,{onRangeEnd:d.setDateRange,modelValue:o.formData.date_range,"onUpdate:modelValue":a[4]||(a[4]=r=>o.formData.date_range=r),range:""},null,8,["onRangeEnd","modelValue"])]),_:1},8,["modelValue"])]),_:1})])])]),_:1}),l(p,{spaced:""}),l(R,{align:"right"},{default:s(()=>[l(c,{flat:"",color:"primary",label:"Cancel",onClick:d.cancelCreate},null,8,["onClick"]),l(c,{color:"primary",label:"Create",onClick:d.createCall},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onSubmit"])])])}var O=v(L,[["render",K]]);const W={components:{CreateCallModal:O},name:"DataTable",data(){return{items:[],currentCall:{},entity:{}}},created(){this.init()},methods:{init(){this.getEntity()},async getEntity(){const e=await this.$api.get("entities/");this.entity=e.data[0],this.$dataStore.setEntity(this.entity),console.log("entity",this.entity),T().then(a=>{console.log("calls",a),this.items=a,this.currentCall=this.items.find(m=>m.id==this.entity.current_call),this.items=this.items.filter(m=>m.id!=this.entity.current_call),console.log("store",this.currentCall),this.$dataStore.setCall(this.currentCall)})},editItem(e){console.log("Edit item:",e)},setAsActiveCall(e){this.$utilsStore.setLoading(!0),this.$api.get(`/calls/${e}/set-as-active`).then(a=>{a.status==200&&(this.init(),this.$utilsStore.setLoading(!1))})},deleteItem(e){confirm("Delete this call?")&&this.$api.delete(`calls/${e}`).then(a=>{a.status==204&&(window.location="/calls")})}}},Q=e=>(E("data-v-21eb985e"),e=e(),I(),e),X={class:"q-ma-md"},Y={align:"right",class:"q-ma-sm"},Z=Q(()=>t("thead",null,[t("tr",null,[t("th",{align:"left"},"Title"),t("th",{align:"left"},"Start"),t("th",{align:"left"},"Submission Date"),t("th",{align:"left"},"Review Date"),t("th",{align:"left"},"Selection Date"),t("th",{align:"left"},"End Date"),t("th",{align:"center"},"Active"),t("th",{align:"left"},"Actions")])],-1)),$={key:0,style:{"background-color":"#dddddd"}},tt={align:"left"},et={align:"left"},lt={align:"left"},at={align:"left"},ot={align:"left"},rt={align:"left"},st={align:"center"},it={align:"left"},nt={align:"center"},dt={key:0},ct=Q(()=>t("p",{class:"text-center q-py-xl q-my-xl text-h3 text-grey"}," No Calls Found! ",-1)),mt={class:"text-center"};function ut(e,a,m,k,o,d){const r=y("CreateCallModal"),h=y("router-link");return u(),b(A,null,{default:s(()=>[t("div",X,[l(V,null,{default:s(()=>[l(D,{icon:"home",to:"/",label:"Home"}),l(D,{label:"Calls",icon:"campaign"})]),_:1})]),l(p,{spaced:""}),t("div",Y,[l(r)]),l(B,{separator:"cell",class:"q-ma-sm",flat:"",bordered:""},{default:s(()=>[Z,t("tbody",null,[o.currentCall?(u(),f("tr",$,[t("th",tt,n(o.currentCall.title),1),t("th",et,n(o.currentCall.date_from),1),t("th",lt,n(o.currentCall.submission_date),1),t("th",at,n(o.currentCall.review_date),1),t("th",ot,n(o.currentCall.selection_date),1),t("th",rt,n(o.currentCall.date_to),1),t("th",st,[l(x,{name:"check_circle_outline",size:"lg",color:"green"})]),t("th",it,[l(h,{to:`/calls/${o.currentCall.id}`},{default:s(()=>[l(c,{icon:"edit",flat:"",color:"primary",onClick:a[0]||(a[0]=i=>d.editItem(o.currentCall))})]),_:1},8,["to"])])])):g("",!0),(u(!0),f(S,null,q(o.items,i=>(u(),f("tr",{key:i.id},[t("td",null,n(i.title),1),t("td",null,n(i.date_from),1),t("td",null,n(i.submission_date),1),t("td",null,n(i.review_date),1),t("td",null,n(i.selection_date),1),t("td",null,n(i.date_to),1),t("td",nt,[l(c,{color:"primary",dense:"",outline:"",label:"set as active",onClick:C=>d.setAsActiveCall(i.id)},null,8,["onClick"])]),t("td",null,[l(h,{to:`/calls/${i.id}`},{default:s(()=>[l(c,{icon:"edit",flat:"",color:"primary",onClick:C=>d.editItem(i)},null,8,["onClick"])]),_:2},1032,["to"]),l(c,{icon:"delete",flat:"",color:"negative",onClick:C=>d.deleteItem(i.id)},null,8,["onClick"])])]))),128))])]),_:1}),!o.currentCall&&o.items.length==0?(u(),f("div",dt,[ct,t("div",mt,[l(h,{to:"/calls/create"},{default:s(()=>[l(c,{color:"primary",outline:"",label:"add call"})]),_:1})])])):g("",!0)]),_:1})}var Lt=v(W,[["render",ut],["__scopeId","data-v-21eb985e"]]);export{Lt as default};
