import{_ as f,o as l,j as a,i as t,f as c,l as p,w as x,u as _,g as r,H as d,t as i,F as g,k as y}from"./index.3671a223.js";import{Q as D}from"./QMarkupTable.4c97a209.js";import"./use-dark.dbbd0c9d.js";const E=new Date,h=E.toISOString().slice(0,10),k={name:"ExpenseReports",components:{},data(){return{formData:{item:"",quantity:1,unit_cost:0,units:"",date:h,proposal:this.$route.params.proposal_id,remarks:""},expenditures:[],isEditing:this.$userHasAnyGroups(["applicant"])&&this.$authStore.currentUser.id==this.$proposalStore.currentProposal.user&&this.$proposalStore.currentProposal.status=="SELECTED"}},created(){this.getExpenditures()},computed:{totalAmount(){return this.expenditures.map(s=>s.unit_cost*s.quantity).reduce((s,m)=>s+m,0)}},methods:{getExpenditures(){this.$api.get("expenditures/").then(n=>{this.expenditures=n.data})},createExpenditure(){this.$api.post("expenditures/",this.formData).then(n=>{console.log("res: ",n.status),n.status==201&&(this.expenditures.push(n.data),this.resetFormData())}).catch(n=>{console.log("err",n.response.data),this.$utilsStore.setLoading(!1)})},deleteExpenditure(n){confirm("Confirm Delete?")&&this.$api.delete(`expenditures/${n}`).then(s=>{console.log("res: ",s.data),this.getExpenditures()})},exportExpenditures(){},resetFormData(){this.formData={item:"",quantity:1,unit_cost:0,units:"",date:h,proposal:this.$route.params.proposal_id,remarks:""}}}},U={class:"q-pa-md"},C={class:"row items-center justify-between"},S=t("div",{class:"text-h6"},"Expense Reports",-1),v={class:"q-gutter-sm"},q=t("th",{class:"text-left"},"Date",-1),b=t("th",{class:"text-left"},"Item",-1),V=t("th",{class:"text-left"},"Quantity",-1),w=t("th",{class:"text-left"},"Units",-1),G=t("th",{class:"text-left"},"Unit Cost",-1),T=t("th",{class:"text-right"},"Total",-1),A=t("th",{class:"text-left"},"Comments",-1),B={key:0,class:"text-left"},F={key:0},Q={class:"text-left"},R={class:"text-left"},X={class:"text-left"},L={class:"text-left"},N={class:"text-left"},j={class:"text-right"},H={class:"text-right"},I={class:"text-left"},M={class:"text-left"},P={class:"text-left"},O={class:"text-left"},z={class:"text-center"},J={class:"text-right"},K={class:"text-right"},W={class:"text-left"},Y={key:0,class:"text-left"},Z=t("td",{colspan:"5",class:"text-left"},[t("strong",null,"Total")],-1),$={class:"text-right"},tt=t("td",{class:"text-left"},[t("strong")],-1),et={key:0,class:"text-left"},st=t("strong",null,null,-1),ot=[st];function nt(n,s,m,it,o,u){return l(),a("div",U,[t("div",C,[S,t("div",v,[c(p,{color:"green",outline:"",flat:"",icon:"download",label:"export",onClick:u.exportExpenditures},null,8,["onClick"])])]),c(D,{flat:"",bordered:""},{default:x(()=>[t("thead",null,[t("tr",null,[q,b,V,w,G,T,A,o.isEditing?(l(),a("th",B,"Action")):_("",!0)])]),t("tbody",null,[o.isEditing?(l(),a("tr",F,[t("td",Q,[r(t("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=e=>o.formData.date=e)},null,512),[[d,o.formData.date]])]),t("td",R,[r(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=e=>o.formData.item=e)},null,512),[[d,o.formData.item]])]),t("td",X,[r(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=e=>o.formData.units=e)},null,512),[[d,o.formData.units]])]),t("td",L,[r(t("input",{type:"number","onUpdate:modelValue":s[3]||(s[3]=e=>o.formData.quantity=e)},null,512),[[d,o.formData.quantity]])]),t("td",N,[r(t("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=e=>o.formData.unit_cost=e)},null,512),[[d,o.formData.unit_cost]])]),t("td",j,i(n.$commaSeparator(o.formData.unit_cost*o.formData.quantity))+" UGX",1),t("td",H,[r(t("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=e=>o.formData.remarks=e)},null,512),[[d,o.formData.remarks]])]),t("td",I,[c(p,{color:"red",label:"submit",flat:"",outline:"",onClick:u.createExpenditure},null,8,["onClick"])])])):_("",!0),(l(!0),a(g,null,y(o.expenditures,e=>(l(),a("tr",{key:e.id},[t("td",M,i(e.date),1),t("td",P,i(e.item),1),t("td",O,i(e.units),1),t("td",z,i(e.quantity),1),t("td",J,i(n.$commaSeparator(e.unit_cost))+" UGX",1),t("td",K,i(n.$commaSeparator(e.quantity*e.unit_cost))+" UGX",1),t("td",W,i(e.remarks),1),o.isEditing?(l(),a("td",Y,[c(p,{color:"red",icon:"delete",onClick:lt=>u.deleteExpenditure(e.id),flat:"",outline:""},null,8,["onClick"])])):_("",!0)]))),128))]),t("tfoot",null,[t("tr",null,[Z,t("td",$,[t("strong",null,i(n.$commaSeparator(u.totalAmount))+" UGX",1)]),tt,o.isEditing?(l(),a("td",et,ot)):_("",!0)])])]),_:1})])}var ut=f(k,[["render",nt]]);export{ut as default};
