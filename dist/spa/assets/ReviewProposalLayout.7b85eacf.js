import{_ as P,H as S,r,o as i,c as p,w as t,a as o,j as m,g as n,f,t as d,s as h,h as _,F as k,i as D,e as C,R as F}from"./index.9b6d8f02.js";import{Q as I}from"./QChip.4ed0a923.js";import{Q as L}from"./QToolbarTitle.11babbcc.js";import{Q as T,a as B,b as O}from"./QLayout.ecade0b0.js";import{Q as V}from"./QHeader.a1c6fc1d.js";import{Q as q}from"./QCard.4957859e.js";import{Q as w}from"./QSeparator.b2724df3.js";import{Q as N,a as R}from"./QItem.7adbf461.js";import{Q as E}from"./QList.afbd39be.js";import{Q as H}from"./QDrawer.0a52857b.js";import{p as j}from"./helpers.dc7d9857.js";import"./use-dark.8dc51c8e.js";import"./scroll.18b40ccd.js";import"./use-prevent-scroll.149239bb.js";import"./use-timeout.da7d71c6.js";import"./TouchPan.1d3dae1b.js";import"./touch.3df10340.js";import"./selection.cce177a4.js";import"./format.3e32b8d9.js";import"./auth.55241972.js";const G=S({name:"ReviewProposalLayout",data(){return{leftDrawerOpen:!1,proposalFiles:[],score:{},sections:[{id:"#problem",name:"The Problem"},{id:"#solution",name:"Proposed Solution"},{id:"#outputs",name:"Outputs, Outcomes and Impact"},{id:"#team",name:"Team Composition"},{id:"#capacity_development",name:"Provision for Capacity Development"},{id:"#scalability",name:"Dissemination, Scalabilty and Sustainability"},{id:"#ethical_implications",name:"Ethical Implications and Enviromental Impact"},{id:"#conflict_of_interest",name:"Conflict of Interest"},{id:"#summary_budget",name:"Summary Budget"},{id:"#summary_budget",name:"Detailed Budget"},{id:"#workplan",name:"Workplan"}]}},created(){j(this.$options.name),this.getProposal()},methods:{getProposal(){this.$utilsStore.setLoading(!0),this.$api.get(`proposals/${this.$route.params.proposal_id}/`).then(e=>{this.proposal=e.data,this.$proposalStore.setProposal(this.proposal),this.getProposalFiles(),this.getSections(),this.getScore(),this.$utilsStore.setLoading(!1)})},getProposalFiles(){this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}`).then(e=>{this.proposalFiles=e.data})},getScore(){var e;this.$api.get(`scores/?user=${((e=this.$authStore.currentUser)==null?void 0:e.id)||0}&proposal=${this.$route.params.proposal_id}`).then(a=>{a.data.length==1&&(this.score=a.data[0])})},deleteFile(e){confirm("Delete this File?")&&this.$api.delete(`files/${e}/`).then(a=>{this.getProposalFiles()})},getSections(){this.$api.get("sections/").then(e=>{this.sections=e.data})},downloadProposal(){this.$api.get(`proposals/${this.$route.params.proposal_id}/pdf/download/`).then(e=>{e.status==200&&window.open(e.data.file_url,"_blank")})},openFile(e){window.open(e)}}}),U={class:"flex"},x=["href"],z={class:"q-px-sm border q-my-auto q-mr-sm"},M={align:"center",class:"q-mb-xl"};function W(e,a,A,J,K,X){const $=r("loading-component"),g=r("submit-proposal"),b=r("proposal-options"),v=r("router-link"),y=r("router-view"),Q=r("score-sheet");return i(),p(O,{view:"lHh Lpr lFf"},{default:t(()=>[o($),o(V,{elevated:""},{default:t(()=>[o(T,{class:"bg-white text-dark"},{default:t(()=>{var s;return[o(m,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:a[0]||(a[0]=l=>e.leftDrawerOpen=!e.leftDrawerOpen)}),o(L,{class:"flex justify-between"},{default:t(()=>{var l,u,c;return[n("div",null,[f(d((l=e.$proposalStore.currentProposal)==null?void 0:l.title)+" ",1),o(I,{color:"secondary",class:"text-white",size:"md",label:(u=e.$proposalStore.currentProposal)==null?void 0:u.status},null,8,["label"])]),((c=e.$proposalStore.currentProposal)==null?void 0:c.status)=="EDITING"?(i(),p(g,{key:0,proposal:e.$proposalStore.currentProposal},null,8,["proposal"])):h("",!0)]}),_:1}),n("div",U,[((s=e.$proposalStore.currentProposal)==null?void 0:s.status)!="EDITING"?(i(),p(m,{key:0,color:"primary",icon:"download",dense:"",label:"download",onClick:e.downloadProposal},null,8,["onClick"])):h("",!0),o(b)])]}),_:1})]),_:1}),o(H,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":a[1]||(a[1]=s=>e.leftDrawerOpen=s),class:"bg-grey-2","show-if-above":"",bordered:"",width:220},{default:t(()=>[o(q,{flat:"",class:"q-py-sm"},{default:t(()=>[o(v,{to:"/proposal-reviews"},{default:t(()=>[o(m,{class:"q-mx-sm",block:"",color:"primary",flat:"",icon:"arrow_back",label:"Proposal Reviews"})]),_:1})]),_:1}),o(w),o(E,null,{default:t(()=>[(i(!0),_(k,null,D(e.sections,(s,l)=>(i(),_("a",{key:s.id,href:`/proposal-reviews/${e.$route.params.proposal_id}${s.ref}`},[C((i(),p(N,{clickable:""},{default:t(()=>[n("div",z,d(l+1),1),o(R,null,{default:t(()=>[f(d(s.title),1)]),_:2},1024)]),_:2},1024)),[[F]]),o(w)],8,x))),128))]),_:1})]),_:1},8,["modelValue"]),o(B,null,{default:t(()=>[o(y),n("div",M,[o(Q)])]),_:1})]),_:1})}var $e=P(G,[["render",W]]);export{$e as default};
