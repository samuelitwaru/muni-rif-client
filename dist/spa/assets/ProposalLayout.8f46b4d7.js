import{_ as Q,H as b,r as l,o as i,c as p,w as t,a as e,j as u,g as n,f as c,t as d,s as f,h,F as v,i as y,e as S,R as k}from"./index.542c6195.js";import{Q as F}from"./QChip.91c2f2a3.js";import{Q as D}from"./QToolbarTitle.3cc2e02b.js";import{Q as C,a as L,b as V}from"./QLayout.5448aff5.js";import{Q as H}from"./QHeader.e67e401c.js";import{Q as B,a as N}from"./QItem.419ce596.js";import{Q as O}from"./QSeparator.d1f4a56a.js";import{Q as T}from"./QList.39042cc1.js";import{Q as I}from"./QDrawer.96f76ee7.js";import{p as q}from"./helpers.f4954f99.js";import{P as j}from"./ProposalHeader.4703ce61.js";import"./use-dark.3250c496.js";import"./scroll.652ffd25.js";import"./use-prevent-scroll.f7d9b58d.js";import"./use-timeout.04e0df1e.js";import"./TouchPan.d6a8bcf5.js";import"./touch.3df10340.js";import"./selection.8c192d65.js";import"./format.3e32b8d9.js";import"./auth.285be793.js";import"./QMarkupTable.131caeae.js";const E=b({components:{ProposalHeader:j},name:"ProposalLayout",data(){return{leftDrawerOpen:!1,proposal:{},proposalFiles:[],score:{},sections:[]}},created(){q(this.$options.name),this.getProposal()},methods:{getProposal(){this.$utilsStore.setLoading(!0),this.$api.get(`proposals/${this.$route.params.proposal_id}/`).then(o=>{this.proposal=o.data,this.$proposalStore.setProposal(this.proposal),this.getProposalFiles(),this.getSections(),this.getScore(),this.$utilsStore.setLoading(!1)})},getProposalFiles(){this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}`).then(o=>{this.proposalFiles=o.data})},getScore(){var o;this.$api.get(`scores/?user=${((o=this.$authStore.currentUser)==null?void 0:o.id)||0}&proposal=${this.$route.params.proposal_id}`).then(s=>{s.data.length==1&&(this.score=s.data[0])})},deleteFile(o){confirm("Delete this File?")&&this.$api.delete(`files/${o}/`).then(s=>{this.getProposalFiles()})},getSections(){this.$api.get("sections/").then(o=>{this.sections=o.data})},downloadProposal(){this.$api.get(`proposals/${this.$route.params.proposal_id}/pdf/download/`).then(o=>{o.status==200&&window.open(o.data.file_url,"_blank")})},openFile(o){window.open(o)}}}),R={class:"flex"},U=["href"],z={class:"q-px-sm border q-my-auto q-mr-sm"};function G(o,s,M,x,A,J){const _=l("loading-component"),$=l("score-sheet"),g=l("proposal-options"),w=l("ProposalHeader"),P=l("router-view");return o.$proposalStore.currentProposal?(i(),p(V,{key:0,view:"lHh Lpr lFf"},{default:t(()=>[e(_),e(H,{elevated:""},{default:t(()=>[e(C,{class:"bg-white text-dark"},{default:t(()=>{var a;return[e(u,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:s[0]||(s[0]=r=>o.leftDrawerOpen=!o.leftDrawerOpen)}),e(D,{class:"flex justify-between"},{default:t(()=>{var r,m;return[n("div",null,[c(d((r=o.$proposalStore.currentProposal)==null?void 0:r.title)+" ",1),e(F,{color:"secondary",class:"text-white",size:"md",label:(m=o.$proposalStore.currentProposal)==null?void 0:m.status},null,8,["label"])])]}),_:1}),n("div",R,[e($),((a=o.$proposalStore.currentProposal)==null?void 0:a.status)!="EDITING"?(i(),p(u,{key:0,color:"primary",icon:"download",dense:"",label:"download",onClick:o.downloadProposal},null,8,["onClick"])):f("",!0),e(g)])]}),_:1})]),_:1}),e(I,{modelValue:o.leftDrawerOpen,"onUpdate:modelValue":s[1]||(s[1]=a=>o.leftDrawerOpen=a),class:"bg-grey-2","show-if-above":"",bordered:"",width:220},{default:t(()=>[e(T,null,{default:t(()=>[(i(!0),h(v,null,y(o.sections,(a,r)=>(i(),h("a",{key:a.id,href:`/proposals/${o.$route.params.proposal_id}${a.ref}`},[S((i(),p(B,{clickable:""},{default:t(()=>[n("div",z,d(r+1),1),e(N,null,{default:t(()=>[c(d(a.title),1)]),_:2},1024)]),_:2},1024)),[[k]]),e(O)],8,U))),128))]),_:1})]),_:1},8,["modelValue"]),e(L,null,{default:t(()=>[e(w),e(P)]),_:1})]),_:1})):f("",!0)}var $o=Q(E,[["render",G]]);export{$o as default};
