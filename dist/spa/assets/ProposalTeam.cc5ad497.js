import{Q as d}from"./QToolbarTitle.26de3cd0.js";import{_ as k,o as l,j as i,i as a,f as s,w as o,h as u,Q as c,t as r,F as _,k as f,e as h,l as Q,u as $,g as b}from"./index.f08ad6ba.js";import{Q as y}from"./QMarkupTable.af8cf3f4.js";import{Q as v}from"./QSeparator.576b1ac8.js";import{Q as S}from"./QItemLabel.2d91268b.js";import{Q as C,a as q}from"./QItem.aa34c858.js";import{Q as D}from"./QList.27f29234.js";import{Q as T}from"./QBtnDropdown.e255e04b.js";import{Q as w}from"./QInput.99fe7471.js";import{Q as L}from"./QCard.7bf12d0a.js";import{C as M}from"./ClosePopup.ebe0e586.js";import"./use-dark.26c7a6e7.js";import"./QBtnGroup.74bec707.js";import"./QMenu.60387a40.js";import"./use-timeout.cff15f03.js";import"./uid.083ad4e2.js";import"./use-transition.5393b565.js";import"./scroll.d4994559.js";import"./use-key-composition.8f3e2ed8.js";import"./use-split-attrs.f128f906.js";import"./use-form.b0f97b95.js";const V={data(){return{team:[],applicants:[],loading:!1,formData:{user:null,email:null,proposal:this.$route.params.proposal_id}}},created(){this.getTeam(),this.getApplicants()},methods:{getTeam(){this.$api.get(`proposals/${this.$route.params.proposal_id}/team`).then(e=>{this.team=e.data})},getApplicants(){this.$api.get("users/?groups__name__in=applicant").then(e=>{this.applicants=e.data})},addMember(){this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/add/`,this.formData).then(e=>{this.team=e.data,this.$utilsStore.setLoading(!1),window.location.reload()})},removeMember(e){confirm("Are you sure you would like to member this member?")&&(this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/remove/`,{user:e}).then(m=>{this.team=m.data,this.$utilsStore.setLoading(!1)}))}}},A={class:"q-pa-sm"},B={class:"text-left q-my-auto"},P={class:"q-pa-sm",for:""},I=a("td",{class:"text-right"},null,-1),N={class:"text-left q-my-auto"},U={class:"q-pa-sm",for:""},x={class:"text-right"},E={key:0},z={class:"row"},F={class:"col-6 q-pa-sm"},j={class:"col-4 q-pa-sm"},G={class:"col-2 q-pa-sm"};function H(e,m,J,K,n,p){return l(),i("div",null,[a("div",A,[s(d,null,{default:o(()=>[u("Team")]),_:1}),s(y,{flat:"",bordered:""},{default:o(()=>[a("tbody",null,[a("tr",null,[a("td",B,[s(c,{size:"sm",name:"person"}),a("label",P,r(e.$proposalStore.currentProposal.user__first_name)+" "+r(e.$proposalStore.currentProposal.user__last_name),1)]),I]),(l(!0),i(_,null,f(n.team,t=>(l(),i("tr",{key:t.id},[a("td",N,[s(c,{size:"sm",name:"person"}),a("label",U,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),a("td",x,[e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),h(Q,{key:0,color:"primary",flat:"",dense:"",icon:"close",onClick:g=>p.removeMember(t.id)},null,8,["onClick"])):$("",!0)])]))),128))])]),_:1}),e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),i("div",E,[s(v,{spaced:""}),s(d,null,{default:o(()=>[u("Add Team Member")]),_:1}),s(L,{flat:"",bordered:"",class:"my-card q-my-sm"},{default:o(()=>[a("div",z,[a("div",F,[s(T,{flat:"",class:"q-mx-sm",label:"Select Member",color:"primary"},{default:o(()=>[s(D,null,{default:o(()=>[(l(!0),i(_,null,f(n.applicants.filter(t=>t.id!=e.$authStore.currentUser.id),t=>b((l(),h(C,{key:t.id,clickable:"",onClick:g=>{this.formData.email=t.email,this.formData.user=t.id}},{default:o(()=>[s(q,null,{default:o(()=>[s(S,null,{default:o(()=>[a("div",null,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1})]),a("div",j,[s(w,{outlined:"",dense:"",modelValue:n.formData.email,"onUpdate:modelValue":m[0]||(m[0]=t=>n.formData.email=t),type:"email",label:"Enter Email Address"},null,8,["modelValue"])]),a("div",G,[s(Q,{color:"primary",label:"Add",onClick:p.addMember},null,8,["onClick"])])])]),_:1})])):$("",!0)])])}var ft=k(V,[["render",H]]);export{ft as default};
