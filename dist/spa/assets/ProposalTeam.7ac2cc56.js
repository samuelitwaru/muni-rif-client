import{Q as d}from"./QToolbarTitle.11babbcc.js";import{_ as b,o as l,h as i,g as a,a as o,w as s,f as u,Q as c,t as r,F as _,i as f,c as h,j as Q,s as $,e as k}from"./index.9b6d8f02.js";import{Q as y}from"./QMarkupTable.e680a5a9.js";import{Q as v}from"./QSeparator.b2724df3.js";import{Q as S}from"./QItemLabel.ba99c664.js";import{Q as C,a as q}from"./QItem.7adbf461.js";import{Q as D}from"./QList.afbd39be.js";import{Q as T}from"./QBtnDropdown.9d39cdb7.js";import{Q as w}from"./QInput.53c1df55.js";import{Q as L}from"./QCard.4957859e.js";import{C as M}from"./ClosePopup.8d4debee.js";import"./use-dark.8dc51c8e.js";import"./QBtnGroup.cfd1d6a9.js";import"./QMenu.61fa0658.js";import"./selection.cce177a4.js";import"./use-timeout.da7d71c6.js";import"./focusout.e24e3d1a.js";import"./focus-manager.b507780d.js";import"./portal.127dfe2c.js";import"./use-transition.8872bac2.js";import"./scroll.18b40ccd.js";import"./uid.9faae8c0.js";import"./use-key-composition.cd9c2a48.js";import"./use-form.33fd784e.js";const V={data(){return{team:[],applicants:[],loading:!1,formData:{user:null,email:null,proposal:this.$route.params.proposal_id}}},created(){this.getTeam(),this.getApplicants()},methods:{getTeam(){this.$api.get(`proposals/${this.$route.params.proposal_id}/team`).then(e=>{this.team=e.data})},getApplicants(){this.$api.get("users/?groups__name__in=applicant").then(e=>{this.applicants=e.data})},addMember(){this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/add/`,this.formData).then(e=>{this.team=e.data,this.$utilsStore.setLoading(!1),window.location.reload()})},removeMember(e){confirm("Are you sure you would like to member this member?")&&(this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/remove/`,{user:e}).then(m=>{this.team=m.data,this.$utilsStore.setLoading(!1)}))}}},A={class:"q-pa-sm"},B={class:"text-left q-my-auto"},P={class:"q-pa-sm",for:""},I=a("td",{class:"text-right"},null,-1),N={class:"text-left q-my-auto"},U={class:"q-pa-sm",for:""},x={class:"text-right"},E={key:0},z={class:"row"},F={class:"col-6 q-pa-sm"},j={class:"col-4 q-pa-sm"},G={class:"col-2 q-pa-sm"};function H(e,m,J,K,p,n){return l(),i("div",null,[a("div",A,[o(d,null,{default:s(()=>[u("Team")]),_:1}),o(y,{flat:"",bordered:""},{default:s(()=>[a("tbody",null,[a("tr",null,[a("td",B,[o(c,{size:"sm",name:"person"}),a("label",P,r(e.$proposalStore.currentProposal.user__first_name)+" "+r(e.$proposalStore.currentProposal.user__last_name),1)]),I]),(l(!0),i(_,null,f(p.team,t=>(l(),i("tr",{key:t.id},[a("td",N,[o(c,{size:"sm",name:"person"}),a("label",U,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),a("td",x,[e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),h(Q,{key:0,color:"primary",flat:"",dense:"",icon:"close",onClick:g=>n.removeMember(t.id)},null,8,["onClick"])):$("",!0)])]))),128))])]),_:1}),e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),i("div",E,[o(v,{spaced:""}),o(d,null,{default:s(()=>[u("Add Team Member")]),_:1}),o(L,{flat:"",bordered:"",class:"my-card q-my-sm"},{default:s(()=>[a("div",z,[a("div",F,[o(T,{flat:"",class:"q-mx-sm",label:"Select Member",color:"primary"},{default:s(()=>[o(D,null,{default:s(()=>[(l(!0),i(_,null,f(p.applicants.filter(t=>t.id!=e.$authStore.currentUser.id),t=>k((l(),h(C,{key:t.id,clickable:"",onClick:g=>{this.formData.email=t.email,this.formData.user=t.id}},{default:s(()=>[o(q,null,{default:s(()=>[o(S,null,{default:s(()=>[a("div",null,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1})]),a("div",j,[o(w,{outlined:"",dense:"",modelValue:p.formData.email,"onUpdate:modelValue":m[0]||(m[0]=t=>p.formData.email=t),type:"email",label:"Enter Email Address"},null,8,["modelValue"])]),a("div",G,[o(Q,{color:"primary",label:"Add",onClick:n.addMember},null,8,["onClick"])])])]),_:1})])):$("",!0)])])}var $t=b(V,[["render",H]]);export{$t as default};
