import{Q as l}from"./QInput.99fe7471.js";import{_ as p,r as c,o as n,j as f,f as a,e as h,w as u,h as _,i as t,t as g,l as w,u as q}from"./index.f08ad6ba.js";import{Q as V}from"./QForm.2a6bce41.js";import{Q as b}from"./QCard.7bf12d0a.js";import"./use-key-composition.8f3e2ed8.js";import"./use-dark.26c7a6e7.js";import"./use-split-attrs.f128f906.js";import"./uid.083ad4e2.js";import"./use-form.b0f97b95.js";const D={data(){return{loading:!1,faculties:[],departments:[],qualifications:[],user:null,formData:{token:this.$route.params.token,first_name:"",last_name:"",password:"",confirm_password:""},emailRules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Email must be valid"],nameRules:[e=>!!e||"Field is required"],phoneRules:[e=>!!e||"Telephone number is required",e=>/^[0-9]{10}$/.test(e)||"Telephone number must be 10 digits"],passwordRules:[e=>!!e||"Password is required",e=>e.length>=8||"Password must be at least 8 characters long"],confirmPasswordRules:[e=>!!e||"Confirm Password is required",e=>e===this.formData.password||"Passwords do not match"],errorResponse:{}}},created(){this.getFaculties(),this.getQualifications(),this.getUser()},methods:{getUser(){this.$api.get(`users/get-user-by-token/${this.$route.params.token}`).then(e=>{this.user=e.data,this.setFormData()})},completeSignup(){this.$utilsStore.setLoading(!0),console.log(this.formData),this.$api.post("accounts/complete-signup/",this.formData).then(e=>{const o=e.data.token,i=e.data.user;this.$authStore.setUserAndToken(i,o),this.$utilsStore.setLoading(!1),this.$router.push("/proposal-reviews")}).catch(e=>{this.$utilsStore.setLoading(!1),this.errorResponse=e.response})},getFaculties(){this.$api.get("faculties/").then(e=>{this.faculties=e.data})},getQualifications(){this.$api.get("qualifications/").then(e=>{this.qualifications=e.data})},signUpWithGoogle(){},setFormData(){this.formData={token:this.$route.params.token,email:this.user.email,first_name:this.user.first_name,last_name:this.user.last_name,phone:this.user.profile.phone,gender:this.user.profile.gender,faculty:this.user.profile.faculty,department:this.user.profile.department,qualification:this.user.profile.qualification,password:"",confirm_password:""}}}},v={align:"center"},R=t("h1",{class:"text-h4"},"Complete Signup",-1),x=t("hr",null,null,-1),k=t("p",null,"Please set your password",-1),y={class:"row q-col-gutter-xs"},S={class:"col"},C={class:"col"},U={class:"row q-col-gutter-xs"},P={class:"col"},Q={class:"row q-col-gutter-xs q-mt-xs"},F={class:"col"},N={class:"row q-col-gutter-xs q-mt-xs"},B={class:"col"},E={class:"flex flex-center"};function L(e,o,i,T,s,m){const d=c("error-message-modal");return n(),f("div",v,[a(d,{errorResponse:s.errorResponse},null,8,["errorResponse"]),s.user?(n(),h(b,{key:0,class:"q-ma-sm q-pa-md",style:{width:"100%"}},{default:u(()=>[R,a(V,{onSubmit:m.completeSignup},{default:u(()=>[x,_(" Welcome, "),t("strong",null,g(s.user.first_name.toUpperCase())+".",1),k,t("div",y,[t("div",S,[a(l,{disable:!0,outlined:"",dense:"",modelValue:s.formData.first_name,"onUpdate:modelValue":o[0]||(o[0]=r=>s.formData.first_name=r),label:"First Name",rules:s.nameRules,required:""},null,8,["modelValue","rules"])]),t("div",C,[a(l,{outlined:"",disable:!0,dense:"",modelValue:s.formData.last_name,"onUpdate:modelValue":o[1]||(o[1]=r=>s.formData.last_name=r),label:"Last Name",rules:s.nameRules,required:""},null,8,["modelValue","rules"])])]),t("div",U,[t("div",P,[a(l,{disable:!0,outlined:"",dense:"",modelValue:s.formData.email,"onUpdate:modelValue":o[2]||(o[2]=r=>s.formData.email=r),label:"Email",rules:s.nameRules,required:""},null,8,["modelValue","rules"])])]),t("div",Q,[t("div",F,[a(l,{outlined:"",dense:"",modelValue:s.formData.password,"onUpdate:modelValue":o[3]||(o[3]=r=>s.formData.password=r),label:"Password",type:"password",rules:s.passwordRules,required:""},null,8,["modelValue","rules"])])]),t("div",N,[t("div",B,[a(l,{outlined:"",dense:"",modelValue:s.formData.confirm_password,"onUpdate:modelValue":o[4]||(o[4]=r=>s.formData.confirm_password=r),label:"Confirm Password",type:"password",rules:s.confirmPasswordRules,required:""},null,8,["modelValue","rules"])])]),t("div",E,[a(w,{type:"submit",color:"primary",label:"Continue"})])]),_:1},8,["onSubmit"])]),_:1})):q("",!0)])}var M=p(D,[["render",L]]);export{M as default};
