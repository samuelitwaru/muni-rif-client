import{Q as w}from"./QChip.7371d580.js";import{Q as p}from"./QItemLabel.2d91268b.js";import{Q as f,a as m}from"./QItem.aa34c858.js";import{Q as y}from"./QList.27f29234.js";import{Q}from"./QSeparator.576b1ac8.js";import{Q as S}from"./QBtnDropdown.e255e04b.js";import{C as d}from"./ClosePopup.ebe0e586.js";import{a as b}from"./api.2118f7e6.js";import{_ as $,r as A,o as l,j as a,h as u,e as n,w as e,f as r,F as P,k as D,u as c,g as C,t as k}from"./index.f08ad6ba.js";const G={props:{color:{type:String,default:"primary"}},name:"CallMenu",data(){return{calls:[],currentCall:null,currentUser:this.$authStore.currentUser}},computed:{otherCalls(){return this.currentCall?this.calls.filter(t=>t.id!=this.currentCall.id):[]},menuItems(){return this.$userHasAnyGroups(["applicant"])?[{name:"My Proposals",icon:"note",route:"/applicant/proposals"},{name:"Profile",icon:"person",route:"/account/profile"}]:this.$userHasAnyGroups(["reviewer"])?[{name:"Reviews",icon:"note",route:"/proposal-reviews"},{name:"Profile",icon:"person",route:"/account/profile"}]:this.$userHasAnyGroups(["grants_officer"])?[{name:"All Proposals",icon:"note",route:"/proposals"},{name:"Profile",icon:"person",route:"/account/profile"}]:[]}},created(){b().then(t=>{if(this.calls=t,this.calls.length){var i=this.calls[0];setTimeout(()=>{console.log("active call",this.$dataStore.currentEntity)},2e3),this.setCurrentCall(this.$dataStore.currentCall||i)}else this.setCurrentCall({title:"No Call Found"})})},methods:{navigateTo(t){this.$router.push(t)},changeCurrentCall(t){this.setCurrentCall(t),window.location="/"},setCurrentCall(t){this.currentCall=t,this.$dataStore.setCall(this.currentCall)}}},H={key:0},N={key:0},x={key:0},B={key:1};function I(t,i,v,E,s,g){const h=A("router-link");return s.currentCall?(l(),a("span",H,[u(" Call: "),s.currentUser&&t.$userHasAnyGroups(["grants_officer"])?(l(),n(S,{key:0,split:"",color:v.color,outline:"","no-caps":"",icon:"folder",label:s.currentCall.title,onClick:i[0]||(i[0]=o=>this.$router.push(`/calls/${s.currentCall.id}`))},{default:e(()=>[t.$userHasAnyGroups(["grants_officer"])?(l(),a("div",N,[s.calls.length?(l(),a("div",x,[r(y,null,{default:e(()=>[(l(!0),a(P,null,D(s.calls,o=>{var _;return C((l(),n(f,{key:o.id,active:o.id==((_=s.currentCall)==null?void 0:_.id),"active-class":"bg-primary text-white",clickable:"",onClick:F=>g.changeCurrentCall(o)},{default:e(()=>[r(m,null,{default:e(()=>[r(p,{class:"flex justify-between items-center"},{default:e(()=>[u(k(o.title)+" ",1),t.$dataStore.currentEntity.current_call==o.id?(l(),n(w,{key:0,color:"secondary",size:"sm",class:"gloss",label:"Active"})):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["active","onClick"])),[[d]])}),128))]),_:1}),r(Q,{spaced:""})])):c("",!0),r(y,null,{default:e(()=>[r(h,{to:"/calls"},{default:e(()=>[C((l(),n(f,{clickable:""},{default:e(()=>[r(m,null,{default:e(()=>[r(p,null,{default:e(()=>[u(" See all calls ...")]),_:1})]),_:1})]),_:1})),[[d]])]),_:1}),r(h,{to:"/calls/create"},{default:e(()=>[C((l(),n(f,{clickable:""},{default:e(()=>[r(m,null,{default:e(()=>[r(p,null,{default:e(()=>[u(" Create New Call ")]),_:1})]),_:1})]),_:1})),[[d]])]),_:1})]),_:1})])):c("",!0)]),_:1},8,["color","label"])):(l(),a("span",B," > "+k(s.currentCall.title),1))])):c("",!0)}var J=$(G,[["render",I]]);export{J as D};
