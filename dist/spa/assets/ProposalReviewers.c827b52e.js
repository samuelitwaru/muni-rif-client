import{Q as g}from"./QToolbarTitle.3cc2e02b.js";import{_ as Q,r as w,o as l,h as n,a as s,g as t,w as r,f as c,c as p,F as u,i as _,t as a,j as f,s as k,e as S}from"./index.542c6195.js";import{Q as y}from"./QMarkupTable.131caeae.js";import{Q as C}from"./QItemLabel.d3c0ae79.js";import{Q as b,a as x}from"./QItem.419ce596.js";import{Q as $}from"./QList.39042cc1.js";import{Q as D}from"./QBtnDropdown.210e256e.js";import{Q as q}from"./QInput.d21a7e16.js";import{Q as L}from"./QCard.afc089a4.js";import{C as V}from"./ClosePopup.887bf137.js";import"./use-dark.3250c496.js";import"./QBtnGroup.6ea4cb74.js";import"./QMenu.349a7bd2.js";import"./selection.8c192d65.js";import"./use-timeout.04e0df1e.js";import"./focusout.e24870b5.js";import"./focus-manager.b507780d.js";import"./use-transition.566a6544.js";import"./scroll.652ffd25.js";import"./uid.42677368.js";import"./use-key-composition.13c30634.js";import"./use-split-attrs.44f15fb2.js";import"./use-form.94504a9c.js";const B={data(){return{scores:[],reviewers:[],loading:!1,formData:{user:null,email:null,proposal:this.$route.params.proposal_id}}},created(){this.getScores(),this.getReviewers()},methods:{getScores(){this.$api.get(`scores/?proposal=${this.$route.params.proposal_id}`).then(o=>{this.scores=o.data})},getReviewers(){this.$api.get("users/?groups__name__in=reviewer").then(o=>{this.reviewers=o.data})},createScore(){this.$utilsStore.setLoading(!0),this.$api.post("scores/",this.formData).then(o=>{o.status==201&&(this.getScores(),this.$utilsStore.setLoading(!1))})},deleteScore(o){confirm("Are you sure you would like to delete this reviewer?")&&(this.$utilsStore.setLoading(!0),this.$api.delete(`scores/${o}/`).then(m=>{m.status==204&&(this.getScores(),this.$utilsStore.setLoading(!1))}))}}},R={class:"q-pa-sm"},A={class:"text-left"},I={class:"text-left"},N={class:"text-left flex"},T=t("label",{class:"text-h6 q-pa-sm"},"Add Reviewer",-1),E={class:"row"},F={class:"col-6 q-pa-sm"},P={class:"col-4 q-pa-sm"},j={class:"col-2 q-pa-sm"};function M(o,m,U,z,i,d){const h=w("proposal-score-sheets");return l(),n("div",null,[s(h),t("div",R,[s(g,null,{default:r(()=>[c("Reviewers")]),_:1}),i.scores.length?(l(),p(y,{key:0,flat:"",bordered:""},{default:r(()=>[t("tbody",null,[(l(!0),n(u,null,_(i.scores,e=>(l(),n("tr",{key:e.id},[t("td",A,a(e.user)+" - "+a(e.user__first_name)+" "+a(e.user__last_name)+" ["+a(e.user__username)+"] ",1),t("td",I,a(e.status),1),t("td",N,[s(f,{color:"primary",icon:"close",flat:"",dense:"",onClick:v=>d.deleteScore(e.id)},null,8,["onClick"])])]))),128))])]),_:1})):k("",!0),s(L,{flat:"",bordered:"",class:"my-card q-my-sm"},{default:r(()=>[T,t("div",E,[t("div",F,[s(D,{flat:"",class:"q-mx-sm",label:"Select reviewer",color:"primary"},{default:r(()=>[s($,null,{default:r(()=>[(l(!0),n(u,null,_(i.reviewers,e=>S((l(),p(b,{key:e.id,clickable:"",onClick:v=>{this.formData.email=e.username,this.formData.user=e.id}},{default:r(()=>[s(x,null,{default:r(()=>[s(C,null,{default:r(()=>[t("div",null,a(e.first_name)+" "+a(e.last_name),1),c(" "+a(e.username),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[V]])),128))]),_:1})]),_:1})]),t("div",P,[s(q,{outlined:"",dense:"",modelValue:i.formData.email,"onUpdate:modelValue":m[0]||(m[0]=e=>i.formData.email=e),type:"email",label:"Enter Email Address"},null,8,["modelValue"])]),t("div",j,[s(f,{color:"primary",label:"Add",onClick:d.createScore},null,8,["onClick"])])])]),_:1})])])}var _e=Q(B,[["render",M]]);export{_e as default};
