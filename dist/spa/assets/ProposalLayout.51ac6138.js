import{_ as P,J as Q,aL as v,r as i,o as l,e as p,w as t,f as o,l as u,i as n,h as f,t as d,v as c,j as h,F as b,k as y,g as S,R as k}from"./index.d46529e0.js";import{Q as F}from"./QChip.ec3eabac.js";import{Q as D}from"./QToolbarTitle.82efc48c.js";import{Q as L,a as C,b as V}from"./QLayout.d2591d5c.js";import{Q as B}from"./QHeader.e0c235ba.js";import{Q as H,a as N}from"./QItem.34036774.js";import{Q as O}from"./QSeparator.3bc38744.js";import{Q as T}from"./QList.3b89b687.js";import{Q as I}from"./QDrawer.0f726175.js";import{P as q}from"./ProposalHeader.239723e7.js";import"./use-dark.dbcb9d7c.js";import"./scroll.d9c3a4e0.js";import"./use-prevent-scroll.520d6742.js";import"./use-timeout.5bbf3409.js";import"./TouchPan.7d1b5411.js";import"./touch.3df10340.js";import"./selection.0f7da341.js";import"./format.3e32b8d9.js";import"./QMarkupTable.ba4ac17a.js";const j=Q({components:{ProposalHeader:q},name:"ProposalLayout",data(){return{leftDrawerOpen:!1,proposal:{},proposalFiles:[],score:{},sections:[]}},created(){v(this.$options.name),this.getProposal()},methods:{getProposal(){this.$utilsStore.setLoading(!0),this.$api.get(`proposals/${this.$route.params.proposal_id}/`).then(e=>{this.proposal=e.data,this.$proposalStore.setProposal(this.proposal),this.getProposalFiles(),this.getSections(),this.getScore(),this.$utilsStore.setLoading(!1)})},getProposalFiles(){this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}`).then(e=>{this.proposalFiles=e.data})},getScore(){var e;this.$api.get(`scores/?user=${((e=this.$authStore.currentUser)==null?void 0:e.id)||0}&proposal=${this.$route.params.proposal_id}`).then(a=>{a.data.length==1&&(this.score=a.data[0])})},deleteFile(e){confirm("Delete this File?")&&this.$api.delete(`files/${e}/`).then(a=>{this.getProposalFiles()})},getSections(){this.$api.get("sections/").then(e=>{this.sections=e.data})},downloadProposal(){this.$api.get(`proposals/${this.$route.params.proposal_id}/pdf/download/`).then(e=>{e.status==200&&window.open(e.data.file_url,"_blank")})},openFile(e){window.open(e)}}}),E={class:"flex"},R=["href"],U={class:"q-px-sm border q-my-auto q-mr-sm"};function z(e,a,G,J,M,x){const _=i("loading-component"),$=i("score-sheet"),g=i("ProposalHeader"),w=i("router-view");return e.$proposalStore.currentProposal?(l(),p(V,{key:0,view:"lHh Lpr lFf"},{default:t(()=>[o(_),o(B,{elevated:""},{default:t(()=>[o(L,{class:"bg-white text-dark"},{default:t(()=>{var s;return[o(u,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:a[0]||(a[0]=r=>e.leftDrawerOpen=!e.leftDrawerOpen)}),o(D,{class:"flex justify-between"},{default:t(()=>{var r,m;return[n("div",null,[f(d((r=e.$proposalStore.currentProposal)==null?void 0:r.title)+" ",1),o(F,{color:"secondary",class:"text-white",size:"md",label:(m=e.$proposalStore.currentProposal)==null?void 0:m.status},null,8,["label"])])]}),_:1}),n("div",E,[o($),((s=e.$proposalStore.currentProposal)==null?void 0:s.status)!="EDITING"?(l(),p(u,{key:0,color:"primary",icon:"download",dense:"",label:"download",onClick:e.downloadProposal},null,8,["onClick"])):c("",!0)])]}),_:1})]),_:1}),o(I,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":a[1]||(a[1]=s=>e.leftDrawerOpen=s),class:"bg-grey-2","show-if-above":"",bordered:"",width:220},{default:t(()=>[o(T,null,{default:t(()=>[(l(!0),h(b,null,y(e.sections,(s,r)=>(l(),h("a",{key:s.id,href:`/proposals/${e.$route.params.proposal_id}${s.ref}`},[S((l(),p(H,{clickable:""},{default:t(()=>[n("div",U,d(r+1),1),o(N,null,{default:t(()=>[f(d(s.title),1)]),_:2},1024)]),_:2},1024)),[[k]]),o(O)],8,R))),128))]),_:1})]),_:1},8,["modelValue"]),o(C,null,{default:t(()=>[o(g),o(w)]),_:1})]),_:1})):c("",!0)}var fe=P(j,[["render",z]]);export{fe as default};
