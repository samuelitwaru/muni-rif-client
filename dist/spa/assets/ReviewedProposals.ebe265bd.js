import{Q as P,a as b}from"./QBreadcrumbs.9c06453f.js";import{Q as x}from"./QSeparator.68732f5d.js";import{Q as q}from"./QSelect.4590551e.js";import{_ as $,r as B,o as l,e as V,w as h,i as e,f as c,j as a,F as p,k as u,t as o,l as C,v as R,aM as T,aN as D}from"./index.1080353d.js";import{Q as I}from"./QMarkupTable.c0451a53.js";import{Q as N}from"./QPage.23d4180f.js";import{u as L}from"./use-quasar.fc25bf67.js";import"./use-dark.6b0451ed.js";import"./use-key-composition.29ef2a66.js";import"./use-split-attrs.338740ca.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./QChip.4f637fd8.js";import"./QItem.9ac5fc30.js";import"./QItemLabel.3fd4d963.js";import"./QMenu.9bbdcf7b.js";import"./selection.c4975593.js";import"./use-timeout.cd2175e4.js";import"./focusout.364dbcfd.js";import"./use-transition.32cb9394.js";import"./scroll.fa986778.js";import"./QDialog.27353340.js";import"./use-prevent-scroll.b4dcc30f.js";import"./use-form.ed2be5bd.js";import"./format.2bc25e5f.js";const U={name:"ReviewerList",data(){return{formData:{theme:null,call:this.$dataStore.currentCall.id},proposals:[],themes:[],sections:[]}},created(){this.$q=L(),this.getSections(),this.getProposals(),this.getThemes()},methods:{getSections(){this.$api.get("sections/").then(t=>{this.sections=t.data.filter(n=>n.max_score>0)})},getProposals(){var t=this.$buildURLQuery(this.formData);this.$api.get(`proposals/?${t}`).then(n=>{this.proposals=n.data,this.getProposalScores()})},getProposalScores(){for(let t=0;t<this.proposals.length;t++){const n=this.proposals[t];this.$api.get(`scores/?proposal=${n.id}`).then(_=>{this.proposals[t].scores=_.data})}},getThemes(){this.$api.get("themes/").then(t=>{this.themes=t.data})},selectProposal(t,n){const _=t.target.checked;this.$api.patch(`proposals/${n}/`,{is_selected:_}).then(Q=>{var i="Proposal added to selected proposals";_||(i="Proposal removed from selected proposals"),this.$q.notify(i)})}}},d=t=>(T("data-v-36f49593"),t=t(),D(),t),A={class:"q-ma-md"},E={align:"right",class:"q-ma-sm row"},F={class:"col"},M=d(()=>e("div",{class:"col"},null,-1)),j=d(()=>e("th",{align:"left"},"Title",-1)),H=d(()=>e("th",{align:"center"},"Total",-1)),z=d(()=>e("th",{align:"center"},"Reviewer",-1)),G=d(()=>e("th",{align:"center"},"Average Score",-1)),J=d(()=>e("th",{align:"left"},null,-1)),K={key:0,class:"q-tr--no-hover text-center"},O=["rowspan"],W={class:"inner"},X=["onClick","checked"],Y={class:"inner"},Z=["rowspan"],ee=["rowspan"],se={class:""},te={class:""};function oe(t,n,_,Q,i,m){const S=B("router-link");return l(),V(N,null,{default:h(()=>[e("div",A,[c(P,null,{default:h(()=>[c(b,{icon:"home",to:"/",label:"Home"}),c(b,{label:"Reviewed Proposals",icon:"list"})]),_:1})]),c(x,{spaced:""}),e("div",E,[e("div",F,[c(q,{modelValue:i.formData.theme,"onUpdate:modelValue":[n[0]||(n[0]=s=>i.formData.theme=s),m.getProposals],dense:"",outlined:"",options:[{id:null,title:"All"}].concat(i.themes),label:"Select Theme","option-value":"id","option-label":"title","map-options":"","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue"])]),M]),c(I,{class:"q-ma-sm my-sticky-column-table","wrap-cells":"",flat:"",bordered:"",dense:""},{default:h(()=>[e("thead",null,[e("tr",null,[j,(l(!0),a(p,null,u(i.sections,s=>(l(),a("th",{key:s.id},o(s.title),1))),128)),H,z,G,J])]),e("tbody",null,[(l(!0),a(p,null,u(i.proposals,s=>{var f,g,v,k,y;return l(),a(p,{key:s.id},[(f=s==null?void 0:s.scores)!=null&&f.length?(l(),a("tr",K,[e("td",{rowspan:(g=s.scores)==null?void 0:g.length,class:"text-left"},[e("table",null,[e("tbody",null,[e("tr",null,[e("td",W,[e("input",{onClick:r=>m.selectProposal(r,s.id),type:"checkbox",checked:s.is_selected},null,8,X)]),e("td",Y,[e("span",null,o(s.title)+" ("+o(s.status)+")",1)])])])])],8,O),(l(!0),a(p,null,u(i.sections,r=>(l(),a("td",{key:r.id},o(s.scores[0][r.name]),1))),128)),e("td",null,o(s.scores[0].total_score),1),e("td",null,o(s.scores[0].user__first_name)+" "+o(s.scores[0].user__last_name)+" ("+o(s.scores[0].user__username)+") ("+o(s.scores[0].status)+") ",1),e("td",{rowspan:(v=s.scores)==null?void 0:v.length},o(s.average_score),9,Z),e("td",{rowspan:(k=s.scores)==null?void 0:k.length},[c(S,{to:`/proposals/${s.id}`},{default:h(()=>[c(C,{color:"primary",icon:"remove_red_eye",flat:"",dense:""})]),_:2},1032,["to"])],8,ee)])):R("",!0),(l(!0),a(p,null,u((y=s.scores)==null?void 0:y.slice(1),r=>(l(),a("tr",{class:"q-tr--no-hover text-center",key:r.id},[(l(!0),a(p,null,u(i.sections,w=>(l(),a("td",{class:"exclude",key:w.id},o(r[w.name]),1))),128)),e("td",se,"\xA0\xA0"+o(r.total_score),1),e("td",te," \xA0\xA0 "+o(r.user__first_name)+" "+o(r.user__last_name)+" ("+o(r.user__username)+") ("+o(r.status)+") ",1)]))),128))],64)}),128))])]),_:1})]),_:1})}var Be=$(U,[["render",oe],["__scopeId","data-v-36f49593"]]);export{Be as default};
