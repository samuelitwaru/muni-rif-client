import{Q as b,a as y}from"./QBreadcrumbs.fe6ab351.js";import{Q as P}from"./QSeparator.b2724df3.js";import{Q as S}from"./QSelect.8a65f9ef.js";import{T as x,aQ as q,_ as C,r as B,o,c as T,w as m,g as e,a as i,h as r,F as p,i as h,t as c,j as V,s as $,aJ as D,aK as R}from"./index.9b6d8f02.js";import{Q as I}from"./QMarkupTable.e680a5a9.js";import{Q as L}from"./QPage.22df8bb6.js";import"./use-dark.8dc51c8e.js";import"./use-key-composition.cd9c2a48.js";import"./uid.9faae8c0.js";import"./focus-manager.b507780d.js";import"./QChip.4ed0a923.js";import"./QItem.7adbf461.js";import"./QItemLabel.ba99c664.js";import"./QMenu.61fa0658.js";import"./selection.cce177a4.js";import"./use-timeout.da7d71c6.js";import"./focusout.e24e3d1a.js";import"./portal.127dfe2c.js";import"./use-transition.8872bac2.js";import"./scroll.18b40ccd.js";import"./QDialog.3343fb4c.js";import"./use-prevent-scroll.149239bb.js";import"./use-form.33fd784e.js";import"./format.3e32b8d9.js";function N(){return x(q)}const U={name:"ReviewerList",data(){return{formData:{theme:null},proposals:[],themes:[],sections:[]}},created(){this.$q=N(),this.getSections(),this.getProposals(),this.getThemes()},methods:{getSections(){this.$api.get("sections/").then(t=>{this.sections=t.data.filter(l=>l.max_score>0)})},getProposals(){var t=this.$buildURLQuery(this.formData);this.$api.get(`proposals/?${t}`).then(l=>{this.proposals=l.data,this.getProposalScores()})},getProposalScores(){for(let t=0;t<this.proposals.length;t++){const l=this.proposals[t];this.$api.get(`scores/?proposal=${l.id}`).then(d=>{this.proposals[t].scores=d.data})}},getThemes(){this.$api.get("themes/").then(t=>{console.log(t.data),this.themes=t.data})},selectProposal(t,l){const d=t.target.checked;this.$api.patch(`proposals/${l}/`,{is_selected:d}).then(w=>{var a="Proposal added to selected proposals";d||(a="Proposal removed from selected proposals"),this.$q.notify(a)})}}},u=t=>(D("data-v-55e620fa"),t=t(),R(),t),j={class:"q-ma-md"},A={align:"right",class:"q-ma-sm row"},E={class:"col"},F=u(()=>e("div",{class:"col"},null,-1)),K=u(()=>e("th",{align:"left"},"Title",-1)),H=u(()=>e("th",{align:"center"},"Total",-1)),J=u(()=>e("th",{align:"center"},"Average Score",-1)),M=u(()=>e("th",{align:"left"},null,-1)),z={key:0,class:"q-tr--no-hover text-center"},G=["rowspan"],O={class:"inner"},W=["onClick","checked"],X={class:"inner"},Y=["rowspan"],Z=["rowspan"],ee={class:""};function te(t,l,d,w,a,_){const Q=B("router-link");return o(),T(L,null,{default:m(()=>[e("div",j,[i(b,null,{default:m(()=>[i(y,{icon:"home",to:"/",label:"Home"}),i(y,{label:"Reviewed Proposals",icon:"list"})]),_:1})]),i(P,{spaced:""}),e("div",A,[e("div",E,[i(S,{modelValue:a.formData.theme,"onUpdate:modelValue":[l[0]||(l[0]=s=>a.formData.theme=s),_.getProposals],dense:"",outlined:"",options:[{id:null,title:"All"}].concat(a.themes),label:"Select Theme","option-value":"id","option-label":"title","map-options":"","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue"])]),F]),i(I,{class:"q-ma-sm my-sticky-column-table","wrap-cells":"",flat:"",bordered:"",dense:""},{default:m(()=>[e("thead",null,[e("tr",null,[K,(o(!0),r(p,null,h(a.sections,s=>(o(),r("th",{key:s.id},c(s.title),1))),128)),H,J,M])]),e("tbody",null,[(o(!0),r(p,null,h(a.proposals,s=>{var g,f,v;return o(),r(p,{key:s.id},[s.scores.length?(o(),r("tr",z,[e("td",{rowspan:(g=s.scores)==null?void 0:g.length,class:"text-left"},[e("table",null,[e("tbody",null,[e("tr",null,[e("td",O,[e("input",{onClick:n=>_.selectProposal(n,s.id),type:"checkbox",checked:s.is_selected},null,8,W)]),e("td",X,[e("span",null,c(s.title),1)])])])])],8,G),(o(!0),r(p,null,h(a.sections,n=>(o(),r("td",{key:n.id},c(s.scores[0][n.name]),1))),128)),e("td",null,c(s.scores[0].total_score),1),e("td",{rowspan:(f=s.scores)==null?void 0:f.length},c(s.average_score),9,Y),e("td",{rowspan:(v=s.scores)==null?void 0:v.length},[i(Q,{to:`/proposals/${s.id}`},{default:m(()=>[i(V,{color:"primary",icon:"remove_red_eye",flat:"",dense:"",onClick:t.onClick},null,8,["onClick"])]),_:2},1032,["to"])],8,Z)])):$("",!0),(o(!0),r(p,null,h(s.scores.slice(1),n=>(o(),r("tr",{class:"q-tr--no-hover text-center",key:n.id},[(o(!0),r(p,null,h(a.sections,k=>(o(),r("td",{class:"exclude",key:k.id},c(n[k.name]),1))),128)),e("td",ee,"\xA0\xA0"+c(n.total_score),1)]))),128))],64)}),128))])]),_:1})]),_:1})}var xe=C(U,[["render",te],["__scopeId","data-v-55e620fa"]]);export{xe as default};
