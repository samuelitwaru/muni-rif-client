import{_ as x,o as i,j as r,f as _,w as g,i as t,n as a,g as d,G as u,t as l,e as m,l as h,q as y,F as k,k as D}from"./index.e39be684.js";import{Q as E}from"./QMarkupTable.c371dead.js";import"./use-dark.54601180.js";const S=new Date,f=S.toISOString().slice(0,10),U={name:"ExpenseReports",components:{},data(){return{formData:{item:"",quantity:1,unit_cost:0,units:"",date:f,proposal:this.$route.params.proposal_id,remarks:""},expenditures:[],isEditing:this.$userHasAnyGroups(["applicant"])&&this.$authStore.currentUser.id==this.$proposalStore.currentProposal.user&&this.$proposalStore.currentProposal.is_selected,isSubmitting:!1}},created(){this.getExpenditures()},computed:{totalAmount(){return this.expenditures.map(o=>o.unit_cost*o.quantity).reduce((o,p)=>o+p,0)}},methods:{getExpenditures(){this.$api.get("expenditures/").then(n=>{this.expenditures=n.data})},createExpenditure(){this.isSubmitting=!0,this.$api.post("expenditures/",this.formData).then(n=>{console.log("res: ",n.status),n.status==201&&(this.expenditures.push(n.data),this.resetFormData(),this.isSubmitting=!1)}).catch(n=>{console.log("err",n.response.data),this.isSubmitting=!1})},deleteExpenditure(n){confirm("Confirm Delete?")&&this.$api.delete(`expenditures/${n}`).then(o=>{console.log("res: ",o.data),this.getExpenditures()})},exportExpenditures(){},resetFormData(){this.formData={item:"",quantity:1,unit_cost:0,units:"",date:f,proposal:this.$route.params.proposal_id,remarks:""}}}},b={class:"q-pa-md"},q=t("div",{id:"reports",class:"row items-center justify-between"},[t("div",{class:"text-h6"},"Expense Reports")],-1),v=t("th",{class:"text-left"},"Date",-1),C=t("th",{class:"text-left"},"Item",-1),V=t("th",{class:"text-left"},"Units",-1),w=t("th",{class:"text-left"},"Quantity",-1),G=t("th",{class:"text-left"},"Unit Cost",-1),B=t("th",{class:"text-right"},"Total",-1),Q=t("th",{class:"text-left"},"Comments",-1),A={key:0,class:"text-left"},F={key:0},N={class:"text-left"},R={class:"text-left"},T={class:"text-left"},X={class:"text-left"},j={class:"text-left"},I={class:"text-right"},M={class:"text-right"},P={class:"text-left"},z={class:"text-left"},H={class:"text-left"},L={class:"text-left"},O={class:"text-center"},J={class:"text-right"},K={class:"text-right"},W={class:"text-left"},Y={key:0,class:"text-left"},Z={key:0,align:"center",colspan:"7"},$={key:0},tt=t("td",{colspan:"5",class:"text-left"},[t("strong",null,"Total")],-1),et={class:"text-right"},st=t("td",{class:"text-left"},[t("strong")],-1),ot={key:0,class:"text-left"},nt=t("strong",null,null,-1),it=[nt];function rt(n,o,p,lt,e,c){return i(),r("div",b,[q,_(E,{flat:"",bordered:""},{default:g(()=>[t("thead",null,[t("tr",null,[v,C,V,w,G,B,Q,e.isEditing?(i(),r("th",A,"Action")):a("",!0)])]),t("tbody",null,[e.isEditing?(i(),r("tr",F,[t("td",N,[d(t("input",{type:"date","onUpdate:modelValue":o[0]||(o[0]=s=>e.formData.date=s)},null,512),[[u,e.formData.date]])]),t("td",R,[d(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=s=>e.formData.item=s)},null,512),[[u,e.formData.item]])]),t("td",T,[d(t("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=s=>e.formData.units=s)},null,512),[[u,e.formData.units]])]),t("td",X,[d(t("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=s=>e.formData.quantity=s)},null,512),[[u,e.formData.quantity]])]),t("td",j,[d(t("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=s=>e.formData.unit_cost=s)},null,512),[[u,e.formData.unit_cost]])]),t("td",I,l(n.$commaSeparator(e.formData.unit_cost*e.formData.quantity))+" UGX",1),t("td",M,[d(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=s=>e.formData.remarks=s)},null,512),[[u,e.formData.remarks]])]),t("td",P,[e.isSubmitting?(i(),m(y,{key:1,color:"primary",size:"1.5rem",thickness:5})):(i(),m(h,{key:0,color:"red",icon:"check",flat:"",outline:"",onClick:c.createExpenditure},null,8,["onClick"]))])])):a("",!0),(i(!0),r(k,null,D(e.expenditures,s=>(i(),r("tr",{key:s.id},[t("td",z,l(s.date),1),t("td",H,l(s.item),1),t("td",L,l(s.units),1),t("td",O,l(s.quantity),1),t("td",J,l(n.$commaSeparator(s.unit_cost))+" UGX",1),t("td",K,l(n.$commaSeparator(s.quantity*s.unit_cost))+" UGX",1),t("td",W,l(s.remarks),1),e.isEditing?(i(),r("td",Y,[_(h,{color:"red",icon:"delete",onClick:at=>c.deleteExpenditure(s.id),flat:"",outline:""},null,8,["onClick"])])):a("",!0)]))),128)),t("tr",null,[e.expenditures.length==0?(i(),r("td",Z," No entries ")):a("",!0)])]),e.expenditures.length?(i(),r("tfoot",$,[t("tr",null,[tt,t("td",et,[t("strong",null,l(n.$commaSeparator(c.totalAmount))+" UGX",1)]),st,e.isEditing?(i(),r("td",ot,it)):a("",!0)])])):a("",!0)]),_:1})])}var pt=x(U,[["render",rt]]);export{pt as default};
