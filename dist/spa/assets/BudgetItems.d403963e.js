import{Q as y}from"./QChip.19e4d28f.js";import{Q as g}from"./QMarkupTable.c371dead.js";import{_,r as b,o as i,j as r,f as m,w as $,i as t,F as p,k as f,t as n,e as F}from"./index.e39be684.js";const k={name:"ProposalAttachments",data(){return{formData:{full_name:"",email:"",telephone:"",proposal:this.$route.params.proposal_id},attachments:[]}},created(){this.init()},methods:{init(){this.getAttachments()},getAttachments(){this.$api.get("attachments/").then(e=>{this.attachments=e.data,this.getFiles()})},getFiles(){for(let e=0;e<this.attachments.length;e++){const a=this.attachments[e];this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}&attachment_id=${a.id}`).then(l=>{var u=l.data;this.attachments.filter(o=>o.id==a.id)[0].files=u,e==this.attachments.length-1&&this.$bus.emit("attachments-updated",this.validateAttachments())})}},validateAttachments(){var e;for(let a=0;a<this.attachments.length;a++){const l=this.attachments[a];if(((e=l==null?void 0:l.files)==null?void 0:e.length)==0)return!1}return!0},deleteFile(e){confirm("Delete this File?")&&this.$api.delete(`files/${e}/`).then(a=>{a.status==204&&this.getFiles()})},openFile(e){window.open(e)}}},B=t("thead",null,[t("tr",null,[t("th",{align:"left"},"Title"),t("th",{align:"left",colspan:"2"},"Files")])],-1),T={class:"flex"};function q(e,a,l,u,o,d){const s=b("proposal-file-attachment");return i(),r("div",null,[m(g,{class:"q-my-sm",flat:"",bordered:""},{default:$(()=>[B,t("tbody",null,[(i(!0),r(p,null,f(o.attachments,c=>(i(),r("tr",{class:"q-tr--no-hover",key:c.id},[t("td",null,n(c.title),1),t("td",null,[t("div",T,[(i(!0),r(p,null,f(c.files,h=>(i(),F(y,{dense:"",key:h.id,class:"glossy",icon:"attachment",label:h.name,removable:e.$userHasAnyGroups(["applicant"])&&e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user&&e.$proposalStore.currentProposal.status=="EDITING",clickable:"",onRemove:v=>d.deleteFile(h.id),onClick:v=>d.openFile(h.file)},null,8,["label","removable","onRemove","onClick"]))),128))])]),t("td",null,[m(s,{attachment_id:c.id,onFileUploaded:a[0]||(a[0]=h=>d.getFiles())},null,8,["attachment_id"])])]))),128))])]),_:1})])}var M=_(k,[["render",q]]);const A={name:"TeamMembers",data(){return{items:[]}},created(){this.init()},methods:{init(){this.getTeams()},getTeams(){this.$api.get(`teams/?proposal=${this.$route.params.proposal_id}`).then(e=>{this.items=e.data})}}},C=t("thead",null,[t("tr",null,[t("th",{align:"left"},"Full Name"),t("th",{align:"left"},"Email"),t("th",{align:"left"},"Telephone"),t("th",{align:"left"},"Role")])],-1);function S(e,a,l,u,o,d){return i(),r("div",null,[m(g,{dense:"",class:"q-my-sm",flat:"",bordered:""},{default:$(()=>[C,t("tbody",null,[(i(!0),r(p,null,f(o.items,s=>(i(),r("tr",{class:"q-tr--no-hover",key:s.id},[t("td",null,n(s.full_name),1),t("td",null,n(s.email),1),t("td",null,n(s.telephone),1),t("td",null,n(s.role),1)]))),128))])]),_:1})])}var R=_(A,[["render",S]]);const U={name:"BudgetItems",data(){return{items:[]}},created(){this.init()},computed:{totalBudget(){var e=0;for(let a=0;a<this.items.length;a++){const l=this.items[a];e+=l.unit_cost*l.quantity}return e}},methods:{init(){this.getBudgets()},getBudgets(){this.$api.get(`budgets/?proposal=${this.$route.params.proposal_id}`).then(e=>{this.items=e.data})}}},I=t("thead",null,[t("tr",null,[t("th",{align:"left"},"Item"),t("th",{align:"left"},"Quantity"),t("th",{align:"left"},"Units"),t("th",{align:"right"},"Unit Cost (UGX)"),t("th",{align:"right"},"Total Cost (UGX)")])],-1),P={align:"right"},Q={align:"right"},w=t("td",{colspan:"4"},"Total",-1),D={align:"right"};function G(e,a,l,u,o,d){return i(),r("div",null,[m(g,{dense:"",class:"q-my-sm",flat:"",bordered:""},{default:$(()=>[I,t("tbody",null,[(i(!0),r(p,null,f(o.items,s=>(i(),r("tr",{key:s.id},[t("td",null,n(s.item),1),t("td",null,n(s.quantity),1),t("td",null,n(s.units),1),t("td",P,n(e.$commaSeparator(s.unit_cost)),1),t("td",Q,n(e.$commaSeparator(s.unit_cost*s.quantity)),1)]))),128)),t("tr",null,[w,t("td",D,n(e.$commaSeparator(d.totalBudget)),1)])])]),_:1})])}var V=_(U,[["render",G]]);export{V as B,M as P,R as T};
