import{Q as P,a as S}from"./QBreadcrumbs.a764f39b.js";import{Q as x}from"./QSeparator.13d6beeb.js";import{Q as $}from"./QSelect.988be1bd.js";import{_ as q,r as B,o as l,e as V,w as h,i as e,f as c,j as n,F as p,k as u,t as o,l as C,n as R,aN as D,aO as T}from"./index.e39be684.js";import{Q as I}from"./QMarkupTable.c371dead.js";import{Q as N}from"./QPage.987cc192.js";import{u as L}from"./use-quasar.f46c6f47.js";import"./use-dark.54601180.js";import"./use-key-composition.de72c202.js";import"./use-split-attrs.ff5e55ff.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./QChip.19e4d28f.js";import"./QItem.c0795fab.js";import"./QItemLabel.aff81a70.js";import"./QMenu.fcff140d.js";import"./use-timeout.65a9f0b9.js";import"./use-transition.c0c5474a.js";import"./scroll.eaa460d0.js";import"./QDialog.f5d6fd89.js";import"./use-prevent-scroll.92142e4c.js";import"./use-form.dc1a9363.js";import"./format.2bc25e5f.js";const U={name:"ReviewerList",data(){return{formData:{theme:null,call:this.$dataStore.currentCall.id},proposals:[],themes:[],sections:[]}},created(){this.$q=L(),this.getSections(),this.getProposals(),this.getThemes()},methods:{getSections(){this.$api.get("sections/").then(t=>{this.sections=t.data.filter(a=>a.max_score>0)})},getProposals(){var t=this.$buildURLQuery(this.formData);this.$api.get(`proposals/?${t}`).then(a=>{console.log("proposals",a.data),this.proposals=a.data.results,this.getProposalScores()})},getProposalScores(){for(let t=0;t<this.proposals.length;t++){const a=this.proposals[t];this.$api.get(`scores/?proposal=${a.id}`).then(_=>{this.proposals[t].scores=_.data})}},getThemes(){this.$api.get("themes/").then(t=>{this.themes=t.data})},selectProposal(t,a){const _=t.target.checked;this.$api.patch(`proposals/${a}/`,{is_selected:_}).then(b=>{var i="Proposal added to selected proposals";_||(i="Proposal removed from selected proposals"),this.$q.notify(i),this.$bus.emit("proposal-selected",{})})}}},d=t=>(D("data-v-7fee674c"),t=t(),T(),t),A={class:"q-ma-md"},E={align:"right",class:"q-ma-sm row"},F={class:"col"},j=d(()=>e("div",{class:"col"},null,-1)),H=d(()=>e("th",{align:"left"},"Selection Status",-1)),M=d(()=>e("th",{align:"center"},"Total",-1)),O=d(()=>e("th",{align:"center"},"Reviewer",-1)),z=d(()=>e("th",{align:"center"},"Average Score",-1)),G=d(()=>e("th",{align:"left"},null,-1)),J={key:0,class:"q-tr--no-hover text-center"},K=["rowspan"],W={class:"inner"},X=["onClick","checked"],Y={class:"inner"},Z=["rowspan"],ee=["rowspan"],se={class:""},te={class:""};function oe(t,a,_,b,i,m){const Q=B("router-link");return l(),V(N,null,{default:h(()=>[e("div",A,[c(P,null,{default:h(()=>[c(S,{icon:"home",to:"/",label:"Home"}),c(S,{label:"Reviewed Proposals",icon:"list"})]),_:1})]),c(x,{spaced:""}),e("div",E,[e("div",F,[c($,{modelValue:i.formData.theme,"onUpdate:modelValue":[a[0]||(a[0]=s=>i.formData.theme=s),m.getProposals],dense:"",outlined:"",options:[{id:null,title:"All"}].concat(i.themes),label:"Select Theme","option-value":"id","option-label":"title","map-options":"","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue"])]),j]),c(I,{class:"q-ma-sm my-sticky-column-table","wrap-cells":"",flat:"",bordered:"",dense:""},{default:h(()=>[e("thead",null,[e("tr",null,[H,(l(!0),n(p,null,u(i.sections,s=>(l(),n("th",{key:s.id},o(s.title),1))),128)),M,O,z,G])]),e("tbody",null,[(l(!0),n(p,null,u(i.proposals,s=>{var f,g,v,k,y;return l(),n(p,{key:s.id},[(f=s==null?void 0:s.scores)!=null&&f.length?(l(),n("tr",J,[e("td",{rowspan:(g=s.scores)==null?void 0:g.length,class:"text-left"},[e("table",null,[e("tbody",null,[e("tr",null,[e("td",W,[e("input",{onClick:r=>m.selectProposal(r,s.id),type:"checkbox",checked:s.is_selected},null,8,X)]),e("td",Y,[e("span",null,o(s.title)+" ("+o(s.status)+")",1)])])])])],8,K),(l(!0),n(p,null,u(i.sections,r=>(l(),n("td",{key:r.id},o(s.scores[0][r.name]),1))),128)),e("td",null,o(s.scores[0].total_score),1),e("td",null,o(s.scores[0].user__first_name)+" "+o(s.scores[0].user__last_name)+" ("+o(s.scores[0].user__username)+") ("+o(s.scores[0].status)+") ",1),e("td",{rowspan:(v=s.scores)==null?void 0:v.length},o(s.average_score),9,Z),e("td",{rowspan:(k=s.scores)==null?void 0:k.length},[c(Q,{to:`/proposals/${s.id}`},{default:h(()=>[c(C,{color:"primary",icon:"remove_red_eye",flat:"",dense:""})]),_:2},1032,["to"])],8,ee)])):R("",!0),(l(!0),n(p,null,u((y=s.scores)==null?void 0:y.slice(1),r=>(l(),n("tr",{class:"q-tr--no-hover text-center",key:r.id},[(l(!0),n(p,null,u(i.sections,w=>(l(),n("td",{class:"exclude",key:w.id},o(r[w.name]),1))),128)),e("td",se,"\xA0\xA0"+o(r.total_score),1),e("td",te," \xA0\xA0 "+o(r.user__first_name)+" "+o(r.user__last_name)+" ("+o(r.user__username)+") ("+o(r.status)+") ",1)]))),128))],64)}),128))])]),_:1})]),_:1})}var $e=q(U,[["render",oe],["__scopeId","data-v-7fee674c"]]);export{$e as default};
