import{Q as d}from"./QToolbarTitle.2734d12e.js";import{_ as k,o as l,j as i,i as a,f as o,w as s,h as u,Q as c,t as r,F as _,k as f,e as h,l as Q,v as $,g as b}from"./index.bedc03b0.js";import{Q as v}from"./QMarkupTable.c0307db7.js";import{Q as y}from"./QSeparator.911a89de.js";import{Q as S}from"./QItemLabel.c829b419.js";import{Q as C,a as q}from"./QItem.881097d0.js";import{Q as D}from"./QList.5067ba24.js";import{Q as T}from"./QBtnDropdown.17cf1504.js";import{Q as w}from"./QInput.f9de55cb.js";import{Q as L}from"./QCard.bbe5bc56.js";import{C as M}from"./ClosePopup.da97b800.js";import"./use-dark.efa299d0.js";import"./QBtnGroup.0eb3eb9a.js";import"./QMenu.016265da.js";import"./selection.06496e30.js";import"./use-timeout.4ebc94f9.js";import"./focusout.95943440.js";import"./focus-manager.b507780d.js";import"./use-transition.d4fcd429.js";import"./scroll.5d411e84.js";import"./uid.42677368.js";import"./use-key-composition.2cb4102f.js";import"./use-split-attrs.11b1e3e4.js";import"./use-form.95f651ae.js";const V={data(){return{team:[],applicants:[],loading:!1,formData:{user:null,email:null,proposal:this.$route.params.proposal_id}}},created(){this.getTeam(),this.getApplicants()},methods:{getTeam(){this.$api.get(`proposals/${this.$route.params.proposal_id}/team`).then(e=>{this.team=e.data})},getApplicants(){this.$api.get("users/?groups__name__in=applicant").then(e=>{this.applicants=e.data})},addMember(){this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/add/`,this.formData).then(e=>{this.team=e.data,this.$utilsStore.setLoading(!1),window.location.reload()})},removeMember(e){confirm("Are you sure you would like to member this member?")&&(this.$utilsStore.setLoading(!0),this.$api.post(`proposals/${this.$route.params.proposal_id}/team/remove/`,{user:e}).then(m=>{this.team=m.data,this.$utilsStore.setLoading(!1)}))}}},A={class:"q-pa-sm"},B={class:"text-left q-my-auto"},P={class:"q-pa-sm",for:""},I=a("td",{class:"text-right"},null,-1),N={class:"text-left q-my-auto"},U={class:"q-pa-sm",for:""},x={class:"text-right"},E={key:0},z={class:"row"},F={class:"col-6 q-pa-sm"},j={class:"col-4 q-pa-sm"},G={class:"col-2 q-pa-sm"};function H(e,m,J,K,p,n){return l(),i("div",null,[a("div",A,[o(d,null,{default:s(()=>[u("Team")]),_:1}),o(v,{flat:"",bordered:""},{default:s(()=>[a("tbody",null,[a("tr",null,[a("td",B,[o(c,{size:"sm",name:"person"}),a("label",P,r(e.$proposalStore.currentProposal.user__first_name)+" "+r(e.$proposalStore.currentProposal.user__last_name),1)]),I]),(l(!0),i(_,null,f(p.team,t=>(l(),i("tr",{key:t.id},[a("td",N,[o(c,{size:"sm",name:"person"}),a("label",U,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),a("td",x,[e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),h(Q,{key:0,color:"primary",flat:"",dense:"",icon:"close",onClick:g=>n.removeMember(t.id)},null,8,["onClick"])):$("",!0)])]))),128))])]),_:1}),e.$authStore.currentUser.id==e.$proposalStore.currentProposal.user?(l(),i("div",E,[o(y,{spaced:""}),o(d,null,{default:s(()=>[u("Add Team Member")]),_:1}),o(L,{flat:"",bordered:"",class:"my-card q-my-sm"},{default:s(()=>[a("div",z,[a("div",F,[o(T,{flat:"",class:"q-mx-sm",label:"Select Member",color:"primary"},{default:s(()=>[o(D,null,{default:s(()=>[(l(!0),i(_,null,f(p.applicants.filter(t=>t.id!=e.$authStore.currentUser.id),t=>b((l(),h(C,{key:t.id,clickable:"",onClick:g=>{this.formData.email=t.email,this.formData.user=t.id}},{default:s(()=>[o(q,null,{default:s(()=>[o(S,null,{default:s(()=>[a("div",null,r(t.first_name)+" "+r(t.last_name)+" ["+r(t.email)+"] ",1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1})]),a("div",j,[o(w,{outlined:"",dense:"",modelValue:p.formData.email,"onUpdate:modelValue":m[0]||(m[0]=t=>p.formData.email=t),type:"email",label:"Enter Email Address"},null,8,["modelValue"])]),a("div",G,[o(Q,{color:"primary",label:"Add",onClick:n.addMember},null,8,["onClick"])])])]),_:1})])):$("",!0)])])}var $t=k(V,[["render",H]]);export{$t as default};
