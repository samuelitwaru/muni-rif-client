import{Q as P,a as w}from"./QBreadcrumbs.b48f041b.js";import{Q as x}from"./QSeparator.f4e84234.js";import{Q as q}from"./QSelect.3b8a2420.js";import{_ as $,r as B,o as a,e as V,w as h,i as e,f as c,j as n,F as p,k as u,t as o,l as C,u as R,aN as T,aO as D}from"./index.3671a223.js";import{Q as I}from"./QMarkupTable.4c97a209.js";import{Q as N}from"./QPage.e8da9ae1.js";import{u as L}from"./use-quasar.0b6dde19.js";import"./use-dark.dbbd0c9d.js";import"./use-key-composition.a7274795.js";import"./use-split-attrs.d467856c.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./QChip.05b39f31.js";import"./QItem.41d22b85.js";import"./QItemLabel.8f35a27f.js";import"./QMenu.2c83730c.js";import"./use-timeout.26584f0c.js";import"./use-transition.1d5f554b.js";import"./scroll.624406d4.js";import"./QDialog.8d8d8cb6.js";import"./use-prevent-scroll.53dc6540.js";import"./use-form.820ebbed.js";import"./format.2bc25e5f.js";const U={name:"ReviewerList",data(){return{formData:{theme:null,call:this.$dataStore.currentCall.id},proposals:[],themes:[],sections:[]}},created(){this.$q=L(),this.getSections(),this.getProposals(),this.getThemes()},methods:{getSections(){this.$api.get("sections/").then(t=>{this.sections=t.data.filter(l=>l.max_score>0)})},getProposals(){var t=this.$buildURLQuery(this.formData);this.$api.get(`proposals/?${t}`).then(l=>{console.log("proposals",l.data),this.proposals=l.data,this.getProposalScores()})},getProposalScores(){for(let t=0;t<this.proposals.length;t++){const l=this.proposals[t];this.$api.get(`scores/?proposal=${l.id}`).then(_=>{this.proposals[t].scores=_.data})}},getThemes(){this.$api.get("themes/").then(t=>{this.themes=t.data})},selectProposal(t,l){const _=t.target.checked;this.$api.patch(`proposals/${l}/`,{is_selected:_}).then(Q=>{var i="Proposal added to selected proposals";_||(i="Proposal removed from selected proposals"),this.$q.notify(i)})}}},d=t=>(T("data-v-71ab1578"),t=t(),D(),t),A={class:"q-ma-md"},E={align:"right",class:"q-ma-sm row"},F={class:"col"},j=d(()=>e("div",{class:"col"},null,-1)),H=d(()=>e("th",{align:"left"},"Title",-1)),M=d(()=>e("th",{align:"center"},"Total",-1)),O=d(()=>e("th",{align:"center"},"Reviewer",-1)),z=d(()=>e("th",{align:"center"},"Average Score",-1)),G=d(()=>e("th",{align:"left"},null,-1)),J={key:0,class:"q-tr--no-hover text-center"},K=["rowspan"],W={class:"inner"},X=["onClick","checked"],Y={class:"inner"},Z=["rowspan"],ee=["rowspan"],se={class:""},te={class:""};function oe(t,l,_,Q,i,m){const S=B("router-link");return a(),V(N,null,{default:h(()=>[e("div",A,[c(P,null,{default:h(()=>[c(w,{icon:"home",to:"/",label:"Home"}),c(w,{label:"Reviewed Proposals",icon:"list"})]),_:1})]),c(x,{spaced:""}),e("div",E,[e("div",F,[c(q,{modelValue:i.formData.theme,"onUpdate:modelValue":[l[0]||(l[0]=s=>i.formData.theme=s),m.getProposals],dense:"",outlined:"",options:[{id:null,title:"All"}].concat(i.themes),label:"Select Theme","option-value":"id","option-label":"title","map-options":"","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue"])]),j]),c(I,{class:"q-ma-sm my-sticky-column-table","wrap-cells":"",flat:"",bordered:"",dense:""},{default:h(()=>[e("thead",null,[e("tr",null,[H,(a(!0),n(p,null,u(i.sections,s=>(a(),n("th",{key:s.id},o(s.title),1))),128)),M,O,z,G])]),e("tbody",null,[(a(!0),n(p,null,u(i.proposals,s=>{var g,f,v,k,y;return a(),n(p,{key:s.id},[(g=s==null?void 0:s.scores)!=null&&g.length?(a(),n("tr",J,[e("td",{rowspan:(f=s.scores)==null?void 0:f.length,class:"text-left"},[e("table",null,[e("tbody",null,[e("tr",null,[e("td",W,[e("input",{onClick:r=>m.selectProposal(r,s.id),type:"checkbox",checked:s.is_selected},null,8,X)]),e("td",Y,[e("span",null,o(s.title)+" ("+o(s.status)+")",1)])])])])],8,K),(a(!0),n(p,null,u(i.sections,r=>(a(),n("td",{key:r.id},o(s.scores[0][r.name]),1))),128)),e("td",null,o(s.scores[0].total_score),1),e("td",null,o(s.scores[0].user__first_name)+" "+o(s.scores[0].user__last_name)+" ("+o(s.scores[0].user__username)+") ("+o(s.scores[0].status)+") ",1),e("td",{rowspan:(v=s.scores)==null?void 0:v.length},o(s.average_score),9,Z),e("td",{rowspan:(k=s.scores)==null?void 0:k.length},[c(S,{to:`/proposals/${s.id}`},{default:h(()=>[c(C,{color:"primary",icon:"remove_red_eye",flat:"",dense:""})]),_:2},1032,["to"])],8,ee)])):R("",!0),(a(!0),n(p,null,u((y=s.scores)==null?void 0:y.slice(1),r=>(a(),n("tr",{class:"q-tr--no-hover text-center",key:r.id},[(a(!0),n(p,null,u(i.sections,b=>(a(),n("td",{class:"exclude",key:b.id},o(r[b.name]),1))),128)),e("td",se,"\xA0\xA0"+o(r.total_score),1),e("td",te," \xA0\xA0 "+o(r.user__first_name)+" "+o(r.user__last_name)+" ("+o(r.user__username)+") ("+o(r.status)+") ",1)]))),128))],64)}),128))])]),_:1})]),_:1})}var qe=$(U,[["render",oe],["__scopeId","data-v-71ab1578"]]);export{qe as default};
