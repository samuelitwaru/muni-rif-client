import{_ as Q,J as v,aL as b,r as l,o as i,e as p,w as t,f as o,l as u,i as n,h as c,t as d,v as f,j as h,F as y,k as S,g as k,R as F}from"./index.3ceec1d0.js";import{Q as D}from"./QChip.992f8412.js";import{Q as L}from"./QToolbarTitle.07383659.js";import{Q as C,a as V,b as B}from"./QLayout.068da9d3.js";import{Q as H}from"./QHeader.0a6aa35f.js";import{Q as N,a as O}from"./QItem.0066d918.js";import{Q as T}from"./QSeparator.f2419a3c.js";import{Q as I}from"./QList.6907dda0.js";import{Q as q}from"./QDrawer.d997af1a.js";import{P as j}from"./ProposalHeader.f53527b9.js";import"./use-dark.cdc1981a.js";import"./scroll.1f71a2f6.js";import"./use-prevent-scroll.1aecfb27.js";import"./use-timeout.a878214f.js";import"./TouchPan.3fb84e77.js";import"./touch.3df10340.js";import"./selection.6ac5d2d4.js";import"./format.3e32b8d9.js";import"./QMarkupTable.0526bcd7.js";const E=v({components:{ProposalHeader:j},name:"ProposalLayout",data(){return{leftDrawerOpen:!1,proposal:{},proposalFiles:[],score:{},sections:[]}},created(){b(this.$options.name),this.getProposal()},methods:{getProposal(){this.$utilsStore.setLoading(!0),this.$api.get(`proposals/${this.$route.params.proposal_id}/`).then(e=>{this.proposal=e.data,this.$proposalStore.setProposal(this.proposal),this.getProposalFiles(),this.getSections(),this.getScore(),this.$utilsStore.setLoading(!1)})},getProposalFiles(){this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}`).then(e=>{this.proposalFiles=e.data})},getScore(){var e;this.$api.get(`scores/?user=${((e=this.$authStore.currentUser)==null?void 0:e.id)||0}&proposal=${this.$route.params.proposal_id}`).then(s=>{s.data.length==1&&(this.score=s.data[0])})},deleteFile(e){confirm("Delete this File?")&&this.$api.delete(`files/${e}/`).then(s=>{this.getProposalFiles()})},getSections(){this.$api.get("sections/").then(e=>{this.sections=e.data})},downloadProposal(){this.$api.get(`proposals/${this.$route.params.proposal_id}/pdf/download/`).then(e=>{e.status==200&&window.open(e.data.file_url,"_blank")})},openFile(e){window.open(e)}}}),R={class:"flex"},U=["href"],z={class:"q-px-sm border q-my-auto q-mr-sm"};function G(e,s,J,M,x,A){const _=l("loading-component"),$=l("score-sheet"),g=l("proposal-options"),w=l("ProposalHeader"),P=l("router-view");return e.$proposalStore.currentProposal?(i(),p(B,{key:0,view:"lHh Lpr lFf"},{default:t(()=>[o(_),o(H,{elevated:""},{default:t(()=>[o(C,{class:"bg-white text-dark"},{default:t(()=>{var a;return[o(u,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:s[0]||(s[0]=r=>e.leftDrawerOpen=!e.leftDrawerOpen)}),o(L,{class:"flex justify-between"},{default:t(()=>{var r,m;return[n("div",null,[c(d((r=e.$proposalStore.currentProposal)==null?void 0:r.title)+" ",1),o(D,{color:"secondary",class:"text-white",size:"md",label:(m=e.$proposalStore.currentProposal)==null?void 0:m.status},null,8,["label"])])]}),_:1}),n("div",R,[o($),((a=e.$proposalStore.currentProposal)==null?void 0:a.status)!="EDITING"?(i(),p(u,{key:0,color:"primary",icon:"download",dense:"",label:"download",onClick:e.downloadProposal},null,8,["onClick"])):f("",!0),o(g)])]}),_:1})]),_:1}),o(q,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":s[1]||(s[1]=a=>e.leftDrawerOpen=a),class:"bg-grey-2","show-if-above":"",bordered:"",width:220},{default:t(()=>[o(I,null,{default:t(()=>[(i(!0),h(y,null,S(e.sections,(a,r)=>(i(),h("a",{key:a.id,href:`/proposals/${e.$route.params.proposal_id}${a.ref}`},[k((i(),p(N,{clickable:""},{default:t(()=>[n("div",z,d(r+1),1),o(O,null,{default:t(()=>[c(d(a.title),1)]),_:2},1024)]),_:2},1024)),[[F]]),o(T)],8,U))),128))]),_:1})]),_:1},8,["modelValue"]),o(V,null,{default:t(()=>[o(w),o(P)]),_:1})]),_:1})):f("",!0)}var fe=Q(E,[["render",G]]);export{fe as default};
