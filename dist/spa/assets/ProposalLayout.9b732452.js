import{_ as Q,H as P,r as l,o as i,c as p,w as t,a as e,j as u,g as n,f as c,t as d,s as b,h as f,F as v,i as y,e as S,R as F}from"./index.9b6d8f02.js";import{Q as k}from"./QChip.4ed0a923.js";import{Q as D}from"./QToolbarTitle.11babbcc.js";import{Q as C,a as L,b as V}from"./QLayout.ecade0b0.js";import{Q as H}from"./QHeader.a1c6fc1d.js";import{Q as B,a as N}from"./QItem.7adbf461.js";import{Q as O}from"./QSeparator.b2724df3.js";import{Q as T}from"./QList.afbd39be.js";import{Q as I}from"./QDrawer.0a52857b.js";import{p as q}from"./helpers.dc7d9857.js";import{P as j}from"./ProposalHeader.334dfe68.js";import"./use-dark.8dc51c8e.js";import"./scroll.18b40ccd.js";import"./use-prevent-scroll.149239bb.js";import"./use-timeout.da7d71c6.js";import"./TouchPan.1d3dae1b.js";import"./touch.3df10340.js";import"./selection.cce177a4.js";import"./format.3e32b8d9.js";import"./auth.55241972.js";import"./QMarkupTable.e680a5a9.js";const E=P({components:{ProposalHeader:j},name:"ProposalLayout",data(){return{leftDrawerOpen:!1,proposal:{},proposalFiles:[],score:{},sections:[]}},created(){q(this.$options.name),this.getProposal()},methods:{getProposal(){this.$utilsStore.setLoading(!0),this.$api.get(`proposals/${this.$route.params.proposal_id}/`).then(o=>{this.proposal=o.data,this.$proposalStore.setProposal(this.proposal),this.getProposalFiles(),this.getSections(),this.getScore(),this.$utilsStore.setLoading(!1)})},getProposalFiles(){this.$api.get(`files/?proposal_id=${this.$route.params.proposal_id}`).then(o=>{this.proposalFiles=o.data})},getScore(){var o;this.$api.get(`scores/?user=${((o=this.$authStore.currentUser)==null?void 0:o.id)||0}&proposal=${this.$route.params.proposal_id}`).then(s=>{s.data.length==1&&(this.score=s.data[0])})},deleteFile(o){confirm("Delete this File?")&&this.$api.delete(`files/${o}/`).then(s=>{this.getProposalFiles()})},getSections(){this.$api.get("sections/").then(o=>{this.sections=o.data})},downloadProposal(){this.$api.get(`proposals/${this.$route.params.proposal_id}/pdf/download/`).then(o=>{o.status==200&&window.open(o.data.file_url,"_blank")})},openFile(o){window.open(o)}}}),R={class:"flex"},U=["href"],x={class:"q-px-sm border q-my-auto q-mr-sm"};function z(o,s,G,M,A,J){const h=l("loading-component"),_=l("score-sheet"),$=l("proposal-options"),g=l("ProposalHeader"),w=l("router-view");return i(),p(V,{view:"lHh Lpr lFf"},{default:t(()=>[e(h),e(H,{elevated:""},{default:t(()=>[e(C,{class:"bg-white text-dark"},{default:t(()=>{var a;return[e(u,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:s[0]||(s[0]=r=>o.leftDrawerOpen=!o.leftDrawerOpen)}),e(D,{class:"flex justify-between"},{default:t(()=>{var r,m;return[n("div",null,[c(d((r=o.$proposalStore.currentProposal)==null?void 0:r.title)+" ",1),e(k,{color:"secondary",class:"text-white",size:"md",label:(m=o.$proposalStore.currentProposal)==null?void 0:m.status},null,8,["label"])])]}),_:1}),n("div",R,[e(_),((a=o.$proposalStore.currentProposal)==null?void 0:a.status)!="EDITING"?(i(),p(u,{key:0,color:"primary",icon:"download",dense:"",label:"download",onClick:o.downloadProposal},null,8,["onClick"])):b("",!0),e($)])]}),_:1})]),_:1}),e(I,{modelValue:o.leftDrawerOpen,"onUpdate:modelValue":s[1]||(s[1]=a=>o.leftDrawerOpen=a),class:"bg-grey-2","show-if-above":"",bordered:"",width:220},{default:t(()=>[e(T,null,{default:t(()=>[(i(!0),f(v,null,y(o.sections,(a,r)=>(i(),f("a",{key:a.id,href:`/proposals/${o.$route.params.proposal_id}${a.ref}`},[S((i(),p(B,{clickable:""},{default:t(()=>[n("div",x,d(r+1),1),e(N,null,{default:t(()=>[c(d(a.title),1)]),_:2},1024)]),_:2},1024)),[[F]]),e(O)],8,U))),128))]),_:1})]),_:1},8,["modelValue"]),e(L,null,{default:t(()=>[e(g),e(w)]),_:1})]),_:1})}var $o=Q(E,[["render",z]]);export{$o as default};
