import{Q as P,a as b}from"./QBreadcrumbs.d3b1227d.js";import{Q as x}from"./QSeparator.3bc38744.js";import{Q as q}from"./QSelect.1a59e37e.js";import{V,aU as $,_ as B,r as C,o as a,e as R,w as h,i as e,f as c,j as l,F as p,k as u,t as o,l as T,v as D,aM as I,aN as N}from"./index.d46529e0.js";import{Q as U}from"./QMarkupTable.ba4ac17a.js";import{Q as L}from"./QPage.0b4c4973.js";import"./use-dark.dbcb9d7c.js";import"./use-key-composition.f4806942.js";import"./use-split-attrs.c45b8af9.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./QChip.ec3eabac.js";import"./QItem.34036774.js";import"./QItemLabel.13041309.js";import"./QMenu.660b48ee.js";import"./selection.0f7da341.js";import"./use-timeout.5bbf3409.js";import"./focusout.59836918.js";import"./use-transition.5b6985ef.js";import"./scroll.d9c3a4e0.js";import"./QDialog.5edcdc8b.js";import"./use-prevent-scroll.520d6742.js";import"./use-form.6837d975.js";import"./format.3e32b8d9.js";function j(){return V($)}const A={name:"ReviewerList",data(){return{formData:{theme:null,call:this.$dataStore.currentCall.id},proposals:[],themes:[],sections:[]}},created(){this.$q=j(),this.getSections(),this.getProposals(),this.getThemes()},methods:{getSections(){this.$api.get("sections/").then(t=>{this.sections=t.data.filter(n=>n.max_score>0)})},getProposals(){var t=this.$buildURLQuery(this.formData);this.$api.get(`proposals/?${t}`).then(n=>{this.proposals=n.data,this.getProposalScores()})},getProposalScores(){for(let t=0;t<this.proposals.length;t++){const n=this.proposals[t];this.$api.get(`scores/?proposal=${n.id}`).then(_=>{this.proposals[t].scores=_.data})}},getThemes(){this.$api.get("themes/").then(t=>{this.themes=t.data})},selectProposal(t,n){const _=t.target.checked;this.$api.patch(`proposals/${n}/`,{is_selected:_}).then(Q=>{var i="Proposal added to selected proposals";_||(i="Proposal removed from selected proposals"),this.$q.notify(i)})}}},d=t=>(I("data-v-36f49593"),t=t(),N(),t),E={class:"q-ma-md"},F={align:"right",class:"q-ma-sm row"},M={class:"col"},H=d(()=>e("div",{class:"col"},null,-1)),K=d(()=>e("th",{align:"left"},"Title",-1)),z=d(()=>e("th",{align:"center"},"Total",-1)),G=d(()=>e("th",{align:"center"},"Reviewer",-1)),J=d(()=>e("th",{align:"center"},"Average Score",-1)),O=d(()=>e("th",{align:"left"},null,-1)),W={key:0,class:"q-tr--no-hover text-center"},X=["rowspan"],Y={class:"inner"},Z=["onClick","checked"],ee={class:"inner"},se=["rowspan"],te=["rowspan"],oe={class:""},re={class:""};function ae(t,n,_,Q,i,m){const S=C("router-link");return a(),R(L,null,{default:h(()=>[e("div",E,[c(P,null,{default:h(()=>[c(b,{icon:"home",to:"/",label:"Home"}),c(b,{label:"Reviewed Proposals",icon:"list"})]),_:1})]),c(x,{spaced:""}),e("div",F,[e("div",M,[c(q,{modelValue:i.formData.theme,"onUpdate:modelValue":[n[0]||(n[0]=s=>i.formData.theme=s),m.getProposals],dense:"",outlined:"",options:[{id:null,title:"All"}].concat(i.themes),label:"Select Theme","option-value":"id","option-label":"title","map-options":"","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue"])]),H]),c(U,{class:"q-ma-sm my-sticky-column-table","wrap-cells":"",flat:"",bordered:"",dense:""},{default:h(()=>[e("thead",null,[e("tr",null,[K,(a(!0),l(p,null,u(i.sections,s=>(a(),l("th",{key:s.id},o(s.title),1))),128)),z,G,J,O])]),e("tbody",null,[(a(!0),l(p,null,u(i.proposals,s=>{var f,g,v,k,y;return a(),l(p,{key:s.id},[(f=s==null?void 0:s.scores)!=null&&f.length?(a(),l("tr",W,[e("td",{rowspan:(g=s.scores)==null?void 0:g.length,class:"text-left"},[e("table",null,[e("tbody",null,[e("tr",null,[e("td",Y,[e("input",{onClick:r=>m.selectProposal(r,s.id),type:"checkbox",checked:s.is_selected},null,8,Z)]),e("td",ee,[e("span",null,o(s.title)+" ("+o(s.status)+")",1)])])])])],8,X),(a(!0),l(p,null,u(i.sections,r=>(a(),l("td",{key:r.id},o(s.scores[0][r.name]),1))),128)),e("td",null,o(s.scores[0].total_score),1),e("td",null,o(s.scores[0].user__first_name)+" "+o(s.scores[0].user__last_name)+" ("+o(s.scores[0].user__username)+") ("+o(s.scores[0].status)+") ",1),e("td",{rowspan:(v=s.scores)==null?void 0:v.length},o(s.average_score),9,se),e("td",{rowspan:(k=s.scores)==null?void 0:k.length},[c(S,{to:`/proposals/${s.id}`},{default:h(()=>[c(T,{color:"primary",icon:"remove_red_eye",flat:"",dense:""})]),_:2},1032,["to"])],8,te)])):D("",!0),(a(!0),l(p,null,u((y=s.scores)==null?void 0:y.slice(1),r=>(a(),l("tr",{class:"q-tr--no-hover text-center",key:r.id},[(a(!0),l(p,null,u(i.sections,w=>(a(),l("td",{class:"exclude",key:w.id},o(r[w.name]),1))),128)),e("td",oe,"\xA0\xA0"+o(r.total_score),1),e("td",re," \xA0\xA0 "+o(r.user__first_name)+" "+o(r.user__last_name)+" ("+o(r.user__username)+") ("+o(r.status)+") ",1)]))),128))],64)}),128))])]),_:1})]),_:1})}var Be=B(A,[["render",ae],["__scopeId","data-v-36f49593"]]);export{Be as default};
