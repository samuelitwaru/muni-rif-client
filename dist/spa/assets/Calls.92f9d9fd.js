import{Q as de,a as M}from"./QBreadcrumbs.a764f39b.js";import{Q as w}from"./QSeparator.13d6beeb.js";import{_ as A,o as C,j as b,e as N,l as g,n as I,i as o,f as a,w as m,aM as ue,t as h,g as me,C as P,s as f,z as s,Q as $,B as H,m as R,y as D,q as F,D as z,as as fe,T as ge,r as B,F as he,k as ve,aN as _e,aO as Ce}from"./index.e39be684.js";import{Q as pe}from"./QMarkupTable.c371dead.js";import{Q as be}from"./QPage.987cc192.js";import"./axios.c31a4c00.js";import{Q as p}from"./QCardSection.1db827b1.js";import{Q as S}from"./QInput.02622759.js";import{Q as ke}from"./QDate.7d42c8cb.js";import{Q as ye}from"./QPopupProxy.768ca227.js";import{Q as T}from"./QCardActions.92136a93.js";import{Q as O}from"./QCard.f9e0a707.js";import{Q as j}from"./QDialog.f5d6fd89.js";import{Q as De}from"./QForm.bfc6ae96.js";import{g as we}from"./api.f52607fc.js";import{C as Ve}from"./ClosePopup.3f3723a2.js";import{Q as Qe}from"./QRadio.1279b3ae.js";import{u as Se,a as xe,b as qe,Q as Be}from"./QCheckbox.40d95456.js";import{a as K,u as G}from"./use-dark.54601180.js";import{u as Ie}from"./use-quasar.f46c6f47.js";import"./use-key-composition.de72c202.js";import"./use-split-attrs.ff5e55ff.js";import"./uid.42677368.js";import"./focus-manager.b507780d.js";import"./use-form.dc1a9363.js";import"./format.2bc25e5f.js";import"./QMenu.fcff140d.js";import"./use-timeout.65a9f0b9.js";import"./use-transition.c0c5474a.js";import"./scroll.eaa460d0.js";import"./use-prevent-scroll.92142e4c.js";import"./option-sizes.3608ba5a.js";const Ae={props:{showButton:{type:Boolean,required:!1,default:!0}},data(){return{showModal:!1,loading:!1,showDialog:!1,showPop:!1,themes:[],formData:{title:"",is_active:!1,date_range:{from:"",to:""},date_from:"",date_to:""},formErrors:{},rules:{required:e=>!!e||"This field is required",dateRangeFrom:e=>!e||!this.formData.date_range.to||e<=this.formData.date_range.to||"Start date must be less than end date",dateRangeTo:e=>!e||!this.formData.date_range.from||e>=this.formData.date_range.from||"End date must be greater than start date"}}},created(){var e,l;we().then(c=>this.themes=c),this.formData.call=(l=(e=this.$dataStore)==null?void 0:e.currentCall)==null?void 0:l.id},methods:{createCall(){this.formData.date_from=this.formData.date_range.from.replaceAll("/","-"),this.formData.date_to=this.formData.date_range.to.replaceAll("/","-"),console.log(this.formData),this.$api.post("calls/",this.formData).then(e=>{console.log("Call created successfully",e.data.id),e.status===201&&e.data.id&&this.$router.push(`/calls/${e.data.id}`)})},setDateRange(){console.log(this.formData.date_range.from,this.formData.date_range.to),this.formData.date_from=this.formData.date_range.from,this.formData.date_to=this.formData.date_range.to,this.showPop=!1},cancelCreate(){this.showDialog=!1},setFormData(){this.formData={title:"sd;d;wdw",is_active:!1,date_range:{from:"2025/04/01",to:"2025/04/30"},date_from:"2025-04-01",date_to:"2025-04-30"}}},watch:{showPopup(e,l){this.showDialog=e},showDialog(e,l){this.$emit("showPopupChanged",e)}}},Pe=o("div",{class:"text-h6"},"New Call",-1),Te={class:"q-mt-md"},Oe=o("label",{class:"text-grey text-caption"}," Select Call Duration ",-1),je={class:"row q-gutter-sm col"};function Ee(e,l,c,v,t,r){return C(),b("div",null,[c.showButton?(C(),N(g,{key:0,label:"New Call",color:"primary",onClick:l[0]||(l[0]=n=>t.showDialog=!0)})):I("",!0),o("div",null,[a(De,{onSubmit:r.createCall,class:"justify-center"},{default:m(()=>[a(j,{modelValue:t.showDialog,"onUpdate:modelValue":l[6]||(l[6]=n=>t.showDialog=n),persistent:""},{default:m(()=>[a(O,{style:{width:"500px"}},{default:m(()=>[a(p,{class:"row justify-between"},{default:m(()=>[Pe,a(g,{color:"primary",icon:"close",dense:"",flat:"",onClick:r.cancelCreate},null,8,["onClick"])]),_:1}),a(w),a(p,{class:"q-pt-lg q-pb-md"},{default:m(()=>[a(S,{modelValue:t.formData.title,"onUpdate:modelValue":l[1]||(l[1]=n=>t.formData.title=n),label:"Title of your call",outlined:"",required:"",rules:[t.rules.required]},null,8,["modelValue","rules"]),o("div",Te,[Oe,o("div",je,[a(S,{class:"col",modelValue:t.formData.date_from,"onUpdate:modelValue":l[2]||(l[2]=n=>t.formData.date_from=n),type:"text",label:"From?",outlined:"",disable:!0},null,8,["modelValue"]),a(S,{class:"col",modelValue:t.formData.date_to,"onUpdate:modelValue":l[3]||(l[3]=n=>t.formData.date_to=n),type:"text",label:"To?",outlined:"",disable:!0},null,8,["modelValue"]),a(g,{icon:"event",outline:"",color:"primary"},{default:m(()=>[a(ye,{cover:"","transition-show":"scale","transition-hide":"scale",modelValue:t.showPop,"onUpdate:modelValue":l[5]||(l[5]=n=>t.showPop=n)},{default:m(()=>[a(ke,{onRangeEnd:r.setDateRange,modelValue:t.formData.date_range,"onUpdate:modelValue":l[4]||(l[4]=n=>t.formData.date_range=n),range:""},null,8,["onRangeEnd","modelValue"])]),_:1},8,["modelValue"])]),_:1})])])]),_:1}),a(w,{spaced:""}),a(T,{align:"right"},{default:m(()=>[a(g,{flat:"",color:"primary",label:"Cancel",onClick:r.cancelCreate},null,8,["onClick"]),a(g,{color:"primary",label:"Create",onClick:r.createCall},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["onSubmit"])])])}var Ue=A(Ae,[["render",Ee]]);const Le={props:{message:{type:String,default:"Comfirm action?"},icon:{type:String,default:"help_outline"},title:{type:String,default:"Confirm"},confirmText:{type:String,default:"Confirm"},cancelText:{type:String,default:"Cancel"}},data(){return{show:!1}},methods:{showDialog(){this.show=!0},hide(){this.show=!1},doConfirm(){this.$emit("confirm",!0),this.show=!1}}},Me={class:"q-ml-sm"};function Re(e,l,c,v,t,r){return C(),b("div",null,[a(j,{modelValue:t.show,"onUpdate:modelValue":l[0]||(l[0]=n=>t.show=n),persistent:""},{default:m(()=>[a(O,null,{default:m(()=>[a(p,{class:"row items-center"},{default:m(()=>[a(ue,{icon:c.icon,color:"primary","text-color":"white"},null,8,["icon"]),o("span",Me,h(c.message),1)]),_:1}),a(T,{align:"right"},{default:m(()=>[me(a(g,{flat:"",label:c.cancelText,color:"primary"},null,8,["label"]),[[Ve]]),a(g,{flat:"",onClick:r.doConfirm,label:c.confirmText,color:"primary"},null,8,["onClick","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Fe=A(Le,[["render",Re]]),ze=P({name:"QToggle",props:{...Se,icon:String,iconColor:String},emits:xe,setup(e){function l(c,v){const t=f(()=>(c.value===!0?e.checkedIcon:v.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),r=f(()=>c.value===!0?e.iconColor:null);return()=>[s("div",{class:"q-toggle__track"}),s("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},t.value!==void 0?[s($,{name:t.value,color:r.value})]:void 0)]}return qe("toggle",l)}});const J={radio:Qe,checkbox:Be,toggle:ze},Ne=Object.keys(J);var $e=P({name:"QOptionGroup",props:{...K,modelValue:{required:!0},options:{type:Array,validator:e=>e.every(l=>"value"in l&&"label"in l)},name:String,type:{default:"radio",validator:e=>Ne.includes(e)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{emit:l,slots:c}){const{proxy:{$q:v}}=H(),t=Array.isArray(e.modelValue);e.type==="radio"?t===!0&&console.error("q-option-group: model should not be array"):t===!1&&console.error("q-option-group: model should be array in your case");const r=G(e,v),n=f(()=>J[e.type]),k=f(()=>"q-option-group q-gutter-x-sm"+(e.inline===!0?" q-option-group--inline":"")),_=f(()=>{const i={role:"group"};return e.type==="radio"&&(i.role="radiogroup",e.disable===!0&&(i["aria-disabled"]="true")),i});function u(i){l("update:modelValue",i)}return()=>s("div",{class:k.value,..._.value},e.options.map((i,y)=>{const V=c["label-"+y]!==void 0?()=>c["label-"+y](i):c.label!==void 0?()=>c.label(i):void 0;return s("div",[s(n.value,{modelValue:e.modelValue,val:i.value,name:i.name===void 0?e.name:i.name,disable:e.disable||i.disable,label:V===void 0?i.label:null,leftLabel:i.leftLabel===void 0?e.leftLabel:i.leftLabel,color:i.color===void 0?e.color:i.color,checkedIcon:i.checkedIcon,uncheckedIcon:i.uncheckedIcon,dark:i.dark||r.value,size:i.size===void 0?e.size:i.size,dense:e.dense,keepColor:i.keepColor===void 0?e.keepColor:i.keepColor,"onUpdate:modelValue":u},V)])}))}});P({name:"DialogPlugin",props:{...K,title:String,message:String,prompt:Object,options:Object,progress:[Boolean,Object],html:Boolean,ok:{type:[String,Object,Boolean],default:!0},cancel:[String,Object,Boolean],focus:{type:String,default:"ok",validator:e=>["ok","cancel","none"].includes(e)},stackButtons:Boolean,color:String,cardClass:[String,Array,Object],cardStyle:[String,Array,Object]},emits:["ok","hide"],setup(e,{emit:l}){const{proxy:c}=H(),{$q:v}=c,t=G(e,v),r=R(null),n=R(e.prompt!==void 0?e.prompt.model:e.options!==void 0?e.options.model:void 0),k=f(()=>"q-dialog-plugin"+(t.value===!0?" q-dialog-plugin--dark q-dark":"")+(e.progress!==!1?" q-dialog-plugin--progress":"")),_=f(()=>e.color||(t.value===!0?"amber":"primary")),u=f(()=>e.progress===!1?null:D(e.progress)===!0?{component:e.progress.spinner||F,props:{color:e.progress.color||_.value}}:{component:F,props:{color:_.value}}),i=f(()=>e.prompt!==void 0||e.options!==void 0),y=f(()=>{if(i.value!==!0)return{};const{model:d,isValid:q,items:dt,...ce}=e.prompt!==void 0?e.prompt:e.options;return ce}),V=f(()=>D(e.ok)===!0||e.ok===!0?v.lang.label.ok:e.ok),X=f(()=>D(e.cancel)===!0||e.cancel===!0?v.lang.label.cancel:e.cancel),E=f(()=>e.prompt!==void 0?e.prompt.isValid!==void 0&&e.prompt.isValid(n.value)!==!0:e.options!==void 0?e.options.isValid!==void 0&&e.options.isValid(n.value)!==!0:!1),Y=f(()=>({color:_.value,label:V.value,ripple:!1,disable:E.value,...D(e.ok)===!0?e.ok:{flat:!0},"data-autofocus":e.focus==="ok"&&i.value!==!0||void 0,onClick:U})),Z=f(()=>({color:_.value,label:X.value,ripple:!1,...D(e.cancel)===!0?e.cancel:{flat:!0},"data-autofocus":e.focus==="cancel"&&i.value!==!0||void 0,onClick:te}));z(()=>e.prompt&&e.prompt.model,Q),z(()=>e.options&&e.options.model,Q);function ee(){r.value.show()}function x(){r.value.hide()}function U(){l("ok",fe(n.value)),x()}function te(){x()}function le(){l("hide")}function Q(d){n.value=d}function ae(d){E.value!==!0&&e.prompt.type!=="textarea"&&ge(d,13)===!0&&U()}function L(d,q){return e.html===!0?s(p,{class:d,innerHTML:q}):s(p,{class:d},()=>q)}function oe(){return[s(S,{color:_.value,dense:!0,autofocus:!0,dark:t.value,...y.value,modelValue:n.value,"onUpdate:modelValue":Q,onKeyup:ae})]}function ie(){return[s($e,{color:_.value,options:e.options.items,dark:t.value,...y.value,modelValue:n.value,"onUpdate:modelValue":Q})]}function ne(){const d=[];return e.cancel&&d.push(s(g,Z.value)),e.ok&&d.push(s(g,Y.value)),s(T,{class:e.stackButtons===!0?"items-end":"",vertical:e.stackButtons,align:"right"},()=>d)}function re(){const d=[];return e.title&&d.push(L("q-dialog__title",e.title)),e.progress!==!1&&d.push(s(p,{class:"q-dialog__progress"},()=>s(u.value.component,u.value.props))),e.message&&d.push(L("q-dialog__message",e.message)),e.prompt!==void 0?d.push(s(p,{class:"scroll q-dialog-plugin__form"},oe)):e.options!==void 0&&d.push(s(w,{dark:t.value}),s(p,{class:"scroll q-dialog-plugin__form"},ie),s(w,{dark:t.value})),(e.ok||e.cancel)&&d.push(ne()),d}function se(){return[s(O,{class:[k.value,e.cardClass],style:e.cardStyle,dark:t.value},re)]}return Object.assign(c,{show:ee,hide:x}),()=>s(j,{ref:r,onHide:le},se)}});Ie();const He={components:{CreateCallModal:Ue,ConfirmDialog:Fe},name:"DataTable",data(){return{items:[],currentCall:{},activeCall:{},entity:{},selectedCallId:null}},created(){this.getEntity()},methods:{async getEntity(){const e=await this.$api.get("entities/");this.entity=e.data[0],this.getCalls()},getCalls(){this.$api.get("calls/").then(e=>{this.calls=e.data,this.calls.length&&(this.activeCall=this.getActiveCall(),this.items=this.calls.filter(l=>l.id!=this.activeCall.id))})},getActiveCall(){return this.calls.find(e=>e.id==this.entity.current_call)},editItem(e){console.log("Edit item:",e)},setAsActiveCall(e){this.$utilsStore.setLoading(!0),this.$api.get(`/calls/${e.id}/set-as-active`).then(l=>{l.status==200&&(this.getEntity(),this.$utilsStore.setLoading(!1),this.$q.notify({type:"positive",message:`${e.title} is now active.`}),this.$bus.emit("set-active-call",e))})},confirmDelete(e){this.selectedCallId=e,console.log(this.$refs.confirmDialog.show=!0),this.$refs.confirmDialog.show()},deleteItem(e){this.$api.delete(`calls/${e}`).then(l=>{l.status==204&&(window.location="/calls")})}}},W=e=>(_e("data-v-78eb1c9c"),e=e(),Ce(),e),Ke={class:"q-ma-md"},Ge={align:"right",class:"q-ma-sm"},Je=W(()=>o("thead",null,[o("tr",null,[o("th",{align:"left"},"Title"),o("th",{align:"left"},"Start"),o("th",{align:"left"},"Submission Date"),o("th",{align:"left"},"Review Date"),o("th",{align:"left"},"Selection Date"),o("th",{align:"left"},"End Date"),o("th",{align:"center"},"Active"),o("th",{align:"left"},"Actions")])],-1)),We={key:0,style:{"background-color":"#dddddd"}},Xe={align:"left"},Ye={align:"left"},Ze={align:"left"},et={align:"left"},tt={align:"left"},lt={align:"left"},at={align:"center"},ot={align:"left"},it={align:"center"},nt={key:0},rt=W(()=>o("p",{class:"text-center q-py-xl q-my-xl text-h3 text-grey"}," No Calls Found! ",-1)),st={class:"text-center"};function ct(e,l,c,v,t,r){const n=B("ConfirmDialog"),k=B("CreateCallModal"),_=B("router-link");return C(),N(be,null,{default:m(()=>[a(n,{ref:"confirmDialog",message:"Are you sure you want to delete this call?",icon:"delete",confirmText:"Delete",cancelText:"Cancel",onConfirm:l[0]||(l[0]=u=>r.deleteItem(t.selectedCallId))},null,512),o("div",Ke,[a(de,null,{default:m(()=>[a(M,{icon:"home",to:"/",label:"Home"}),a(M,{label:"Calls",icon:"campaign"})]),_:1})]),a(w,{spaced:""}),o("div",Ge,[a(k)]),a(pe,{separator:"cell",class:"q-ma-sm",flat:"",bordered:""},{default:m(()=>[Je,o("tbody",null,[t.activeCall?(C(),b("tr",We,[o("th",Xe,h(t.activeCall.title),1),o("th",Ye,h(t.activeCall.date_from),1),o("th",Ze,h(t.activeCall.submission_date),1),o("th",et,h(t.activeCall.review_date),1),o("th",tt,h(t.activeCall.selection_date),1),o("th",lt,h(t.activeCall.date_to),1),o("th",at,[a($,{name:"check_circle_outline",size:"lg",color:"green"})]),o("th",ot,[a(_,{to:`/calls/${t.activeCall.id}`},{default:m(()=>[a(g,{icon:"edit",flat:"",color:"primary",onClick:l[1]||(l[1]=u=>r.editItem(t.activeCall))})]),_:1},8,["to"])])])):I("",!0),(C(!0),b(he,null,ve(t.items,u=>(C(),b("tr",{key:u.id},[o("td",null,h(u.title),1),o("td",null,h(u.date_from),1),o("td",null,h(u.submission_date),1),o("td",null,h(u.review_date),1),o("td",null,h(u.selection_date),1),o("td",null,h(u.date_to),1),o("td",it,[a(g,{color:"primary",dense:"",outline:"",label:"set as active",onClick:i=>r.setAsActiveCall(u)},null,8,["onClick"])]),o("td",null,[a(_,{to:`/calls/${u.id}`},{default:m(()=>[a(g,{icon:"edit",flat:"",color:"primary",onClick:i=>r.editItem(u)},null,8,["onClick"])]),_:2},1032,["to"]),a(g,{icon:"delete",flat:"",color:"negative",onClick:i=>r.confirmDelete(u.id)},null,8,["onClick"])])]))),128))])]),_:1}),!t.currentCall&&t.items.length==0?(C(),b("div",nt,[rt,o("div",st,[a(_,{to:"/calls/create"},{default:m(()=>[a(g,{color:"primary",outline:"",label:"add call"})]),_:1})])])):I("",!0)]),_:1})}var zt=A(He,[["render",ct],["__scopeId","data-v-78eb1c9c"]]);export{zt as default};
